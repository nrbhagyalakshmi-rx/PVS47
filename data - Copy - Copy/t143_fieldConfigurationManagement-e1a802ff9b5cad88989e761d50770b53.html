var signal=signal||{};
signal.fieldManagement=function(){var f,d=[],l=!0,n,p,g=function(){var u=function(c){var e=function(){return _.filter(d,function(a){return 1===a.containerView})},b=function(){return _.filter(d,function(a){return 2===a.containerView})},r=function(){return _.filter(d,function(a){return 3===a.containerView})},m=function(a,b){var c=b;return _.reduce(a,function(a,b){_.has(b,"listOrder")||(b.listOrder=c++);return a=a+('<a href="#" class="list-group-item" data-field="'+b.name+'">'+b.label+"</a>")+"\n"},
"")},t=function(){f.find(".list-group-primary").html(m(_.sortBy(e(),function(a){return a.listOrder}),0))},a=function(){f.find(".list-group-secondary").html(m(_.sortBy(b(),function(a){return a.listOrder}),0))};(function(){$.ajax({url:n,cache:!1,async:!1,success:function(b){b&&0<b.length&&(d=_.collect(b,function(a){var b={};b.name=a.name;b.label=a.label;b.seq=a.seq;b.listOrder=a.listOrder;b.containerView=a.containerView;return b}));setColumnSeq(d);t();a();f.find(".list-group-optional").html(m(r(),0))}})})()},
h=function(c,e,b){var d=function(c){return _.find(b,function(a){return a.name===c}).seq},f=0;return _.reduce(c.children("a.list-group-item"),function(b,a){var c=$(a).html();a=$(a).attr("data-field");var k={};k.label=c;k.name=a;k.containerView=e;k.seq=d(a);k.listOrder=f++;b.push(k);return b},[])},g=function(c){var e=_.filter(d,function(b){return 1===b.containerView});return c?_.sortBy(e,function(b){return b.listOrder}):e},v=function(c){var e=_.filter(d,function(b){return 2===b.containerView});return c?
_.sortBy(e,function(b){return b.listOrder}):e},q=function(c,e){var b=$(c).dataTable().fnSettings().aoColumns.length,d=function(){for(var e=[],a=0;a<b;a++)e.push({idx:a,name:$(c).dataTable().fnSettings().aoColumns[a].mData});return e},f=function(){var b=d(),a=[],c=g(!0);l?(l=!1,_.each(c,function(c){var e=_.find(b,function(a){return c.name===a.name});e&&a.push(e.idx)})):a=_.collect(c,function(a){return _.find(b,function(b){return a.name===b.name})?a.seq:0});return a};return function(){var c=_.range(0,
e),a=_.range(0,b),d=f(),a=_.filter(a,function(a){return!_.contains(d,a)}),a=d.concat(a),a=_.difference(a,c);return a=_.union(c,a)}()},x=function(c,e,b){var f=function(){var b=0,c=0;_.each(d,function(a){a.listOrder=9999});_.each(g(),function(a){a.listOrder=b++});_.each(v(),function(a){a.listOrder=c++});return d}();c.colReorder.order(q(e,b),!0);w(d,c,b);$(".yadcf-filter-wrapper").hide();c.draw();$.ajax({url:p,method:"POST",data:{columnList:JSON.stringify(f)},success:function(b){}})},w=function(c,e,
b){var d=[],f=[];_.each(c,function(c,a){1===c.containerView?d.push(a+b):f.push(a+b)});e.columns(d).visible(!0);e.columns(f).visible(!1)};return{init:function(c){c&&("0px"===f.css("right")?f.css("right",-350):f.css("right","0"));c=f.data("fieldcontainerreference");u(c);f.find(".display-config-field, .display-config-field2, .display-config-field3").sortable({connectWith:".short-field"}).disableSelection()},hideFieldConfigurationPanel:function(){f.css("right",-350);$(".field-config-bar-toggle").data("backdrop")&&
(1>$("#wrapper").find(".fieldconfig-backdrop").length?$("<div class='fieldconfig-backdrop'></div>").appendTo("#wrapper"):$(".fieldconfig-backdrop").remove())},processList:function(c,e,b){var g=h(f.find(".list-group-primary"),1,d),g=g.concat(h(f.find(".list-group-secondary"),2,d));d=g=g.concat(h(f.find(".list-group-optional"),3,d));x(c,e,b)},buildColumnOrder:q,visible:function(c){var e=_.find(d,function(b){return b.name===c&&1===b.containerView});return!_.isEmpty(e)}}}();return{init:function(d,h,l){$("#configureQualitativeFields, #configureValidatedSignalFields, #configureQuantitativeFields, #configureEvdasFields, #configureAdhocFields,#configureLiteratureFields").click(function(d){d.preventDefault();
f=$("#"+$(this).data("fieldconfigurationbarid"));g.init(!0)});$("#btnSaveListConfig").unbind("click").on("click",function(f){f.preventDefault();g.processList(d,h,l);g.hideFieldConfigurationPanel()});$("#btnCloseListConfig").click(function(d){d.preventDefault();g.hideFieldConfigurationPanel()});d.colReorder.order(g.buildColumnOrder(h,l),!0)},visibleColumns:function(d){return g.visible(d)},populateColumnList:function(d,h){f=$("#qualitativeFields, #validatedSignalFields, #quantitativeFields, #evdasFields, #adhocFields");
n=d;p=h;g.init(!1)}}}();