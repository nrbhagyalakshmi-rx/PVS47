<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="135">
  <HTTPTask id="789" hostname="10.100.22.24:8181" path="/signal/assets/vendorUi/datatables/datatable.colsReorder.min-f60fbf698f1fa675a29d5b361968020a.js" url="http://10.100.22.24:8181/signal/assets/vendorUi/datatables/datatable.colsReorder.min-f60fbf698f1fa675a29d5b361968020a.js" ip="10.100.22.24" port="8181" connectionId="30" origin="Primary" frame="1" startDateTime="2020-05-22T11:19:00.897+05:30" startTime="89389859" endTime="89390281">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Host" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTAuMTAwLjIyLjI0OjgxODE=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgxLjAuNDA0NC4xMzggU2FmYXJpLzUzNy4zNg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cDovLzEwLjEwMC4yMi4yNDo4MTgxL3NpZ25hbC9zaW5nbGVDYXNlQWxlcnQvZGV0YWlscz9jYWxsaW5nU2NyZWVuPXJldmlldyZjb25maWdJZD0xNQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tVVMsZW47cT0wLjk=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U0VTU0lPTj04ZmE2YTc5MS0zOTFlLTRkNDItYjAzNi0xYzUwNjdhYzZkOGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9zaWduYWwvYXNzZXRzL3ZlbmRvclVpL2RhdGF0YWJsZXMvZGF0YXRhYmxlLmNvbHNSZW9yZGVyLm1pbi1mNjBmYmY2OThmMWZhNjc1YTI5ZDViMzYxOTY4MDIwYS5qcyBIVFRQLzEuMQ0KSG9zdDogMTAuMTAwLjIyLjI0OjgxODENCkNvbm5lY3Rpb246IGtlZXAtYWxpdmUNClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84MS4wLjQwNDQuMTM4IFNhZmFyaS81MzcuMzYNCkFjY2VwdDogKi8qDQpSZWZlcmVyOiBodHRwOi8vMTAuMTAwLjIyLjI0OjgxODEvc2lnbmFsL3NpbmdsZUNhc2VBbGVydC9kZXRhaWxzP2NhbGxpbmdTY3JlZW49cmV2aWV3JmNvbmZpZ0lkPTE1DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNCkFjY2VwdC1MYW5ndWFnZTogZW4tVVMsZW47cT0wLjkNCkNvb2tpZTogU0VTU0lPTj04ZmE2YTc5MS0zOTFlLTRkNDItYjAzNi0xYzUwNjdhYzZkOGUNCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="SESSION" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>OGZhNmE3OTEtMzkxZS00ZDQyLWIwMzYtMWM1MDY3YWM2ZDhl</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>10865</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Last-Modified" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAyMSBNYXkgMjAyMCAwODoxOTowMCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>InZlbmRvclVpL2RhdGF0YWJsZXMvZGF0YXRhYmxlLmNvbHNSZW9yZGVyLm1pbi1mNjBmYmY2OThmMWZhNjc1YTI5ZDViMzYxOTY4MDIwYS5qcyI=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>cHVibGljLCBtYXgtYWdlPTMxNTM2MDAw</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdDtjaGFyc2V0PVVURi04</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTA4NjU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>RnJpLCAyMiBNYXkgMjAyMCAwNTo0MDoxNiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIA0KTGFzdC1Nb2RpZmllZDogVGh1LCAyMSBNYXkgMjAyMCAwODoxOTowMCBHTVQNCkVUYWc6ICJ2ZW5kb3JVaS9kYXRhdGFibGVzL2RhdGF0YWJsZS5jb2xzUmVvcmRlci5taW4tZjYwZmJmNjk4ZjFmYTY3NWEyOWQ1YjM2MTk2ODAyMGEuanMiDQpWYXJ5OiBBY2NlcHQtRW5jb2RpbmcNCkNhY2hlLUNvbnRyb2w6IHB1YmxpYywgbWF4LWFnZT0zMTUzNjAwMA0KQ29udGVudC1FbmNvZGluZzogZ3ppcA0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0O2NoYXJzZXQ9VVRGLTgNCkNvbnRlbnQtTGVuZ3RoOiAxMDg2NQ0KRGF0ZTogRnJpLCAyMiBNYXkgMjAyMCAwNTo0MDoxNiBHTVQNCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>LyohIENvbFJlb3JkZXIgMS4zLjMNCiAqIMKpMjAxMC0yMDE1IFNwcnlNZWRpYSBMdGQgLSBkYXRhdGFibGVzLm5ldC9saWNlbnNlDQogKi8NCg0KLyoqDQogKiBAc3VtbWFyeSAgICAgQ29sUmVvcmRlcg0KICogQGRlc2NyaXB0aW9uIFByb3ZpZGUgdGhlIGFiaWxpdHkgdG8gcmVvcmRlciBjb2x1bW5zIGluIGEgRGF0YVRhYmxlDQogKiBAdmVyc2lvbiAgICAgMS4zLjMNCiAqIEBmaWxlICAgICAgICBkYXRhVGFibGVzLmNvbFJlb3JkZXIuanMNCiAqIEBhdXRob3IgICAgICBTcHJ5TWVkaWEgTHRkICh3d3cuc3ByeW1lZGlhLmNvLnVrKQ0KICogQGNvbnRhY3QgICAgIHd3dy5zcHJ5bWVkaWEuY28udWsvY29udGFjdA0KICogQGNvcHlyaWdodCAgIENvcHlyaWdodCAyMDEwLTIwMTQgU3ByeU1lZGlhIEx0ZC4NCiAqDQogKiBUaGlzIHNvdXJjZSBmaWxlIGlzIGZyZWUgc29mdHdhcmUsIGF2YWlsYWJsZSB1bmRlciB0aGUgZm9sbG93aW5nIGxpY2Vuc2U6DQogKiAgIE1JVCBsaWNlbnNlIC0gaHR0cDovL2RhdGF0YWJsZXMubmV0L2xpY2Vuc2UvbWl0DQogKg0KICogVGhpcyBzb3VyY2UgZmlsZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBidXQNCiAqIFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YgTUVSQ0hBTlRBQklMSVRZDQogKiBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gU2VlIHRoZSBsaWNlbnNlIGZpbGVzIGZvciBkZXRhaWxzLg0KICoNCiAqIEZvciBkZXRhaWxzIHBsZWFzZSByZWZlciB0bzogaHR0cDovL3d3dy5kYXRhdGFibGVzLm5ldA0KICovDQooZnVuY3Rpb24oIGZhY3RvcnkgKXsNCiAgICBpZiAoIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHsNCiAgICAgICAgLy8gQU1EDQogICAgICAgIGRlZmluZSggWydqcXVlcnknLCAnZGF0YXRhYmxlcy5uZXQnXSwgZnVuY3Rpb24gKCAkICkgew0KICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkoICQsIHdpbmRvdywgZG9jdW1lbnQgKTsNCiAgICAgICAgfSApOw0KICAgIH0NCiAgICBlbHNlIGlmICggdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICkgew0KICAgICAgICAvLyBDb21tb25KUw0KICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChyb290LCAkKSB7DQogICAgICAgICAgICBpZiAoICEgcm9vdCApIHsNCiAgICAgICAgICAgICAgICByb290ID0gd2luZG93Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoICEgJCB8fCAhICQuZm4uZGF0YVRhYmxlICkgew0KICAgICAgICAgICAgICAgICQgPSByZXF1aXJlKCdkYXRhdGFibGVzLm5ldCcpKHJvb3QsICQpLiQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5KCAkLCByb290LCByb290LmRvY3VtZW50ICk7DQogICAgICAgIH07DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgICAvLyBCcm93c2VyDQogICAgICAgIGZhY3RvcnkoIGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCApOw0KICAgIH0NCn0oZnVuY3Rpb24oICQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCApIHsNCiAgICAndXNlIHN0cmljdCc7DQogICAgdmFyIERhdGFUYWJsZSA9ICQuZm4uZGF0YVRhYmxlOw0KDQoNCiAgICAvKioNCiAgICAgKiBTd2l0Y2ggdGhlIGtleSB2YWx1ZSBwYWlyaW5nIG9mIGFuIGluZGV4IGFycmF5IHRvIGJlIHZhbHVlIGtleSAoaS5lLiB0aGUgb2xkIHZhbHVlIGlzIG5vdyB0aGUNCiAgICAgKiBrZXkpLiBGb3IgZXhhbXBsZSBjb25zaWRlciBbIDIsIDAsIDEgXSB0aGlzIHdvdWxkIGJlIHJldHVybmVkIGFzIFsgMSwgMiwgMCBdLg0KICAgICAqICBAbWV0aG9kICBmbkludmVydEtleVZhbHVlcw0KICAgICAqICBAcGFyYW0gICBhcnJheSBhSW4gQXJyYXkgdG8gc3dpdGNoIGFyb3VuZA0KICAgICAqICBAcmV0dXJucyBhcnJheQ0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGZuSW52ZXJ0S2V5VmFsdWVzKCBhSW4gKQ0KICAgIHsNCiAgICAgICAgdmFyIGFSZXQ9W107DQogICAgICAgIGZvciAoIHZhciBpPTAsIGlMZW49YUluLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgIHsNCiAgICAgICAgICAgIGFSZXRbIGFJbltpXSBdID0gaTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gYVJldDsNCiAgICB9DQoNCg0KICAgIC8qKg0KICAgICAqIE1vZGlmeSBhbiBhcnJheSBieSBzd2l0Y2hpbmcgdGhlIHBvc2l0aW9uIG9mIHR3byBlbGVtZW50cw0KICAgICAqICBAbWV0aG9kICBmbkFycmF5U3dpdGNoDQogICAgICogIEBwYXJhbSAgIGFycmF5IGFBcnJheSBBcnJheSB0byBjb25zaWRlciwgd2lsbCBiZSBtb2RpZmllZCBieSByZWZlcmVuY2UgKGkuZS4gbm8gcmV0dXJuKQ0KICAgICAqICBAcGFyYW0gICBpbnQgaUZyb20gRnJvbSBwb2ludA0KICAgICAqICBAcGFyYW0gICBpbnQgaVRvIEluc2VydCBwb2ludA0KICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICovDQogICAgZnVuY3Rpb24gZm5BcnJheVN3aXRjaCggYUFycmF5LCBpRnJvbSwgaVRvICkNCiAgICB7DQogICAgICAgIHZhciBtU3RvcmUgPSBhQXJyYXkuc3BsaWNlKCBpRnJvbSwgMSApWzBdOw0KICAgICAgICBhQXJyYXkuc3BsaWNlKCBpVG8sIDAsIG1TdG9yZSApOw0KICAgIH0NCg0KDQogICAgLyoqDQogICAgICogU3dpdGNoIHRoZSBwb3NpdGlvbnMgb2Ygbm9kZXMgaW4gYSBwYXJlbnQgbm9kZSAobm90ZSB0aGlzIGlzIHNwZWNpZmljYWxseSBkZXNpZ25lZCBmb3INCiAgICAgKiB0YWJsZSByb3dzKS4gTm90ZSB0aGlzIGZ1bmN0aW9uIGNvbnNpZGVycyBhbGwgZWxlbWVudCBub2RlcyB1bmRlciB0aGUgcGFyZW50IQ0KICAgICAqICBAbWV0aG9kICBmbkRvbVN3aXRjaA0KICAgICAqICBAcGFyYW0gICBzdHJpbmcgc1RhZyBUYWcgdG8gY29uc2lkZXINCiAgICAgKiAgQHBhcmFtICAgaW50IGlGcm9tIEVsZW1lbnQgdG8gbW92ZQ0KICAgICAqICBAcGFyYW0gICBpbnQgUG9pbnQgdG8gZWxlbWVudCB0aGUgZWxlbWVudCB0byAoYmVmb3JlIHRoaXMgcG9pbnQpLCBjYW4gYmUgbnVsbCBmb3IgYXBwZW5kDQogICAgICogIEByZXR1cm5zIHZvaWQNCiAgICAgKi8NCiAgICBmdW5jdGlvbiBmbkRvbVN3aXRjaCggblBhcmVudCwgaUZyb20sIGlUbyApDQogICAgew0KICAgICAgICB2YXIgYW5UYWdzID0gW107DQogICAgICAgIGZvciAoIHZhciBpPTAsIGlMZW49blBhcmVudC5jaGlsZE5vZGVzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICggblBhcmVudC5jaGlsZE5vZGVzW2ldLm5vZGVUeXBlID09IDEgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGFuVGFncy5wdXNoKCBuUGFyZW50LmNoaWxkTm9kZXNbaV0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICB2YXIgblN0b3JlID0gYW5UYWdzWyBpRnJvbSBdOw0KDQogICAgICAgIGlmICggaVRvICE9PSBudWxsICkNCiAgICAgICAgew0KICAgICAgICAgICAgblBhcmVudC5pbnNlcnRCZWZvcmUoIG5TdG9yZSwgYW5UYWdzW2lUb10gKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIG5QYXJlbnQuYXBwZW5kQ2hpbGQoIG5TdG9yZSApOw0KICAgICAgICB9DQogICAgfQ0KDQoNCiAgICAvKioNCiAgICAgKiBQbHVnLWluIGZvciBEYXRhVGFibGVzIHdoaWNoIHdpbGwgcmVvcmRlciB0aGUgaW50ZXJuYWwgY29sdW1uIHN0cnVjdHVyZSBieSB0YWtpbmcgdGhlIGNvbHVtbg0KICAgICAqIGZyb20gb25lIHBvc2l0aW9uIChpRnJvbSkgYW5kIGluc2VydCBpdCBpbnRvIGEgZ2l2ZW4gcG9pbnQgKGlUbykuDQogICAgICogIEBtZXRob2QgICQuZm4uZGF0YVRhYmxlRXh0Lm9BcGkuZm5Db2xSZW9yZGVyDQogICAgICogIEBwYXJhbSAgIG9iamVjdCBvU2V0dGluZ3MgRGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QgLSBhdXRvbWF0aWNhbGx5IGFkZGVkIGJ5IERhdGFUYWJsZXMhDQogICAgICogIEBwYXJhbSAgIGludCBpRnJvbSBUYWtlIHRoZSBjb2x1bW4gdG8gYmUgcmVwb3NpdGlvbmVkIGZyb20gdGhpcyBwb2ludA0KICAgICAqICBAcGFyYW0gICBpbnQgaVRvIGFuZCBpbnNlcnQgaXQgaW50byB0aGlzIHBvaW50DQogICAgICogIEBwYXJhbSAgIGJvb2wgZHJvcCBJbmRpY2F0ZSBpZiB0aGUgcmVvcmRlciBpcyB0aGUgZmluYWwgb25lIChpLmUuIGEgZHJvcCkNCiAgICAgKiAgICBub3QgYSBsaXZlIHJlb3JkZXINCiAgICAgKiAgQHBhcmFtICAgYm9vbCBpbnZhbGlkYXRlUm93cyBzcGVlZHMgdXAgcHJvY2Vzc2luZyBpZiBmYWxzZSBwYXNzZWQNCiAgICAgKiAgQHJldHVybnMgdm9pZA0KICAgICAqLw0KICAgICQuZm4uZGF0YVRhYmxlRXh0Lm9BcGkuZm5Db2xSZW9yZGVyID0gZnVuY3Rpb24gKCBvU2V0dGluZ3MsIGlGcm9tLCBpVG8sIGRyb3AsIGludmFsaWRhdGVSb3dzICkNCiAgICB7DQogICAgICAgIHZhciBpLCBpTGVuLCBqLCBqTGVuLCBqZW4sIGlDb2xzPW9TZXR0aW5ncy5hb0NvbHVtbnMubGVuZ3RoLCBuVHJzLCBvQ29sOw0KICAgICAgICB2YXIgYXR0ck1hcCA9IGZ1bmN0aW9uICggb2JqLCBwcm9wLCBtYXBwaW5nICkgew0KICAgICAgICAgICAgaWYgKCAhIG9ialsgcHJvcCBdIHx8IHR5cGVvZiBvYmpbIHByb3AgXSA9PT0gJ2Z1bmN0aW9uJyApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBhID0gb2JqWyBwcm9wIF0uc3BsaXQoJy4nKTsNCiAgICAgICAgICAgIHZhciBudW0gPSBhLnNoaWZ0KCk7DQoNCiAgICAgICAgICAgIGlmICggaXNOYU4oIG51bSoxICkgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBvYmpbIHByb3AgXSA9IG1hcHBpbmdbIG51bSoxIF0rJy4nK2Euam9pbignLicpOw0KICAgICAgICB9Ow0KDQogICAgICAgIC8qIFNhbml0eSBjaGVjayBpbiB0aGUgaW5wdXQgKi8NCiAgICAgICAgaWYgKCBpRnJvbSA9PSBpVG8gKQ0KICAgICAgICB7DQogICAgICAgICAgICAvKiBQb2ludGxlc3MgcmVvcmRlciAqLw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCBpRnJvbSA8IDAgfHwgaUZyb20gPj0gaUNvbHMgKQ0KICAgICAgICB7DQogICAgICAgICAgICB0aGlzLm9BcGkuX2ZuTG9nKCBvU2V0dGluZ3MsIDEsICJDb2xSZW9yZGVyICdmcm9tJyBpbmRleCBpcyBvdXQgb2YgYm91bmRzOiAiK2lGcm9tICk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIGlUbyA8IDAgfHwgaVRvID49IGlDb2xzICkNCiAgICAgICAgew0KICAgICAgICAgICAgdGhpcy5vQXBpLl9mbkxvZyggb1NldHRpbmdzLCAxLCAiQ29sUmVvcmRlciAndG8nIGluZGV4IGlzIG91dCBvZiBib3VuZHM6ICIraVRvICk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICAvKg0KICAgICAgICAgKiBDYWxjdWxhdGUgdGhlIG5ldyBjb2x1bW4gYXJyYXkgaW5kZXgsIHNvIHdlIGhhdmUgYSBtYXBwaW5nIGJldHdlZW4gdGhlIG9sZCBhbmQgbmV3DQogICAgICAgICAqLw0KICAgICAgICB2YXIgYWlNYXBwaW5nID0gW107DQogICAgICAgIGZvciAoIGk9MCwgaUxlbj1pQ29scyA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgIHsNCiAgICAgICAgICAgIGFpTWFwcGluZ1tpXSA9IGk7DQogICAgICAgIH0NCiAgICAgICAgZm5BcnJheVN3aXRjaCggYWlNYXBwaW5nLCBpRnJvbSwgaVRvICk7DQogICAgICAgIHZhciBhaUludmVydE1hcHBpbmcgPSBmbkludmVydEtleVZhbHVlcyggYWlNYXBwaW5nICk7DQoNCg0KICAgICAgICAvKg0KICAgICAgICAgKiBDb252ZXJ0IGFsbCBpbnRlcm5hbCBpbmRleGluZyB0byB0aGUgbmV3IGNvbHVtbiBvcmRlciBpbmRleGVzDQogICAgICAgICAqLw0KICAgICAgICAvKiBTb3J0aW5nICovDQogICAgICAgIGZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYWFTb3J0aW5nLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgIHsNCiAgICAgICAgICAgIG9TZXR0aW5ncy5hYVNvcnRpbmdbaV1bMF0gPSBhaUludmVydE1hcHBpbmdbIG9TZXR0aW5ncy5hYVNvcnRpbmdbaV1bMF0gXTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qIEZpeGVkIHNvcnRpbmcgKi8NCiAgICAgICAgaWYgKCBvU2V0dGluZ3MuYWFTb3J0aW5nRml4ZWQgIT09IG51bGwgKQ0KICAgICAgICB7DQogICAgICAgICAgICBmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFhU29ydGluZ0ZpeGVkLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgb1NldHRpbmdzLmFhU29ydGluZ0ZpeGVkW2ldWzBdID0gYWlJbnZlcnRNYXBwaW5nWyBvU2V0dGluZ3MuYWFTb3J0aW5nRml4ZWRbaV1bMF0gXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8qIERhdGEgY29sdW1uIHNvcnRpbmcgKHRoZSBjb2x1bW4gd2hpY2ggdGhlIHNvcnQgZm9yIGEgZ2l2ZW4gY29sdW1uIHNob3VsZCB0YWtlIHBsYWNlIG9uKSAqLw0KICAgICAgICBmb3IgKCBpPTAsIGlMZW49aUNvbHMgOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICB7DQogICAgICAgICAgICBvQ29sID0gb1NldHRpbmdzLmFvQ29sdW1uc1tpXTsNCiAgICAgICAgICAgIGZvciAoIGo9MCwgakxlbj1vQ29sLmFEYXRhU29ydC5sZW5ndGggOyBqPGpMZW4gOyBqKysgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIG9Db2wuYURhdGFTb3J0W2pdID0gYWlJbnZlcnRNYXBwaW5nWyBvQ29sLmFEYXRhU29ydFtqXSBdOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGNvbHVtbiBpbmRleGVzDQogICAgICAgICAgICBvQ29sLmlkeCA9IGFpSW52ZXJ0TWFwcGluZ1sgb0NvbC5pZHggXTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFVwZGF0ZSAxLjEwIG9wdGltaXNlZCBzb3J0IGNsYXNzIHJlbW92YWwgdmFyaWFibGUNCiAgICAgICAgJC5lYWNoKCBvU2V0dGluZ3MuYUxhc3RTb3J0LCBmdW5jdGlvbiAoaSwgdmFsKSB7DQogICAgICAgICAgICBvU2V0dGluZ3MuYUxhc3RTb3J0W2ldLnNyYyA9IGFpSW52ZXJ0TWFwcGluZ1sgdmFsLnNyYyBdOw0KICAgICAgICB9ICk7DQoNCiAgICAgICAgLyogVXBkYXRlIHRoZSBHZXQgYW5kIFNldCBmdW5jdGlvbnMgZm9yIGVhY2ggY29sdW1uICovDQogICAgICAgIGZvciAoIGk9MCwgaUxlbj1pQ29scyA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgIHsNCiAgICAgICAgICAgIG9Db2wgPSBvU2V0dGluZ3MuYW9Db2x1bW5zW2ldOw0KDQogICAgICAgICAgICBpZiAoIHR5cGVvZiBvQ29sLm1EYXRhID09ICdudW1iZXInICkgew0KICAgICAgICAgICAgICAgIG9Db2wubURhdGEgPSBhaUludmVydE1hcHBpbmdbIG9Db2wubURhdGEgXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYgKCAkLmlzUGxhaW5PYmplY3QoIG9Db2wubURhdGEgKSApIHsNCiAgICAgICAgICAgICAgICAvLyBIVE1MNSBkYXRhIHNvdXJjZWQNCiAgICAgICAgICAgICAgICBhdHRyTWFwKCBvQ29sLm1EYXRhLCAnXycsICAgICAgYWlJbnZlcnRNYXBwaW5nICk7DQogICAgICAgICAgICAgICAgYXR0ck1hcCggb0NvbC5tRGF0YSwgJ2ZpbHRlcicsIGFpSW52ZXJ0TWFwcGluZyApOw0KICAgICAgICAgICAgICAgIGF0dHJNYXAoIG9Db2wubURhdGEsICdzb3J0JywgICBhaUludmVydE1hcHBpbmcgKTsNCiAgICAgICAgICAgICAgICBhdHRyTWFwKCBvQ29sLm1EYXRhLCAndHlwZScsICAgYWlJbnZlcnRNYXBwaW5nICk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvKg0KICAgICAgICAgKiBNb3ZlIHRoZSBET00gZWxlbWVudHMNCiAgICAgICAgICovDQogICAgICAgIGlmICggb1NldHRpbmdzLmFvQ29sdW1uc1tpRnJvbV0uYlZpc2libGUgKQ0KICAgICAgICB7DQogICAgICAgICAgICAvKiBDYWxjdWxhdGUgdGhlIGN1cnJlbnQgdmlzaWJsZSBpbmRleCBhbmQgdGhlIHBvaW50IHRvIGluc2VydCB0aGUgbm9kZSBiZWZvcmUuIFRoZSBpbnNlcnQNCiAgICAgICAgICAgICAqIGJlZm9yZSBuZWVkcyB0byB0YWtlIGludG8gYWNjb3VudCB0aGF0IHRoZXJlIG1pZ2h0IG5vdCBiZSBhbiBlbGVtZW50IHRvIGluc2VydCBiZWZvcmUsDQogICAgICAgICAgICAgKiBpbiB3aGljaCBjYXNlIGl0IHdpbGwgYmUgbnVsbCwgYW5kIGFuIGFwcGVuZENoaWxkIHNob3VsZCBiZSB1c2VkDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIHZhciBpVmlzaWJsZUluZGV4ID0gdGhpcy5vQXBpLl9mbkNvbHVtbkluZGV4VG9WaXNpYmxlKCBvU2V0dGluZ3MsIGlGcm9tICk7DQogICAgICAgICAgICB2YXIgaUluc2VydEJlZm9yZUluZGV4ID0gbnVsbDsNCg0KICAgICAgICAgICAgaSA9IGlUbyA8IGlGcm9tID8gaVRvIDogaVRvICsgMTsNCiAgICAgICAgICAgIHdoaWxlICggaUluc2VydEJlZm9yZUluZGV4ID09PSBudWxsICYmIGkgPCBpQ29scyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaUluc2VydEJlZm9yZUluZGV4ID0gdGhpcy5vQXBpLl9mbkNvbHVtbkluZGV4VG9WaXNpYmxlKCBvU2V0dGluZ3MsIGkgKTsNCiAgICAgICAgICAgICAgICBpKys7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIEhlYWRlciAqLw0KICAgICAgICAgICAgblRycyA9IG9TZXR0aW5ncy5uVEhlYWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RyJyk7DQogICAgICAgICAgICBmb3IgKCBpPTAsIGlMZW49blRycy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGZuRG9tU3dpdGNoKCBuVHJzW2ldLCBpVmlzaWJsZUluZGV4LCBpSW5zZXJ0QmVmb3JlSW5kZXggKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogRm9vdGVyICovDQogICAgICAgICAgICBpZiAoIG9TZXR0aW5ncy5uVEZvb3QgIT09IG51bGwgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIG5UcnMgPSBvU2V0dGluZ3MublRGb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0cicpOw0KICAgICAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1uVHJzLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBmbkRvbVN3aXRjaCggblRyc1tpXSwgaVZpc2libGVJbmRleCwgaUluc2VydEJlZm9yZUluZGV4ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKiBCb2R5ICovDQogICAgICAgICAgICBmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvRGF0YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICggb1NldHRpbmdzLmFvRGF0YVtpXS5uVHIgIT09IG51bGwgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZm5Eb21Td2l0Y2goIG9TZXR0aW5ncy5hb0RhdGFbaV0ublRyLCBpVmlzaWJsZUluZGV4LCBpSW5zZXJ0QmVmb3JlSW5kZXggKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvKg0KICAgICAgICAgKiBNb3ZlIHRoZSBpbnRlcm5hbCBhcnJheSBlbGVtZW50cw0KICAgICAgICAgKi8NCiAgICAgICAgLyogQ29sdW1ucyAqLw0KICAgICAgICBmbkFycmF5U3dpdGNoKCBvU2V0dGluZ3MuYW9Db2x1bW5zLCBpRnJvbSwgaVRvICk7DQoNCiAgICAgICAgLy8gcmVnZW5lcmF0ZSB0aGUgZ2V0IC8gc2V0IGZ1bmN0aW9ucw0KICAgICAgICBmb3IgKCBpPTAsIGlMZW49aUNvbHMgOyBpPGlMZW4gOyBpKysgKSB7DQogICAgICAgICAgICBvU2V0dGluZ3Mub0FwaS5fZm5Db2x1bW5PcHRpb25zKCBvU2V0dGluZ3MsIGksIHt9ICk7DQogICAgICAgIH0NCg0KICAgICAgICAvKiBTZWFyY2ggY29sdW1ucyAqLw0KICAgICAgICBmbkFycmF5U3dpdGNoKCBvU2V0dGluZ3MuYW9QcmVTZWFyY2hDb2xzLCBpRnJvbSwgaVRvICk7DQoNCiAgICAgICAgLyogQXJyYXkgYXJyYXkgLSBpbnRlcm5hbCBkYXRhIGFub2RlcyBjYWNoZSAqLw0KICAgICAgICBmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvRGF0YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgZGF0YSA9IG9TZXR0aW5ncy5hb0RhdGFbaV07DQogICAgICAgICAgICB2YXIgY2VsbHMgPSBkYXRhLmFuQ2VsbHM7DQoNCiAgICAgICAgICAgIGlmICggY2VsbHMgKSB7DQogICAgICAgICAgICAgICAgZm5BcnJheVN3aXRjaCggY2VsbHMsIGlGcm9tLCBpVG8gKTsNCg0KICAgICAgICAgICAgICAgIC8vIExvbmdlciB0ZXJtLCBzaG91bGQgdGhpcyBiZSBtb3ZlZCBpbnRvIHRoZSBEYXRhVGFibGVzJyBpbnZhbGlkYXRlDQogICAgICAgICAgICAgICAgLy8gbWV0aG9kcz8NCiAgICAgICAgICAgICAgICBmb3IgKCBqPTAsIGplbj1jZWxscy5sZW5ndGggOyBqPGplbiA7IGorKyApIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCBjZWxsc1tqXSAmJiBjZWxsc1tqXS5fRFRfQ2VsbEluZGV4ICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2VsbHNbal0uX0RUX0NlbGxJbmRleC5jb2x1bW4gPSBqOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBGb3IgRE9NIHNvdXJjZWQgZGF0YSwgdGhlIGludmFsaWRhdGUgd2lsbCByZXJlYWQgdGhlIGNlbGwgaW50bw0KICAgICAgICAgICAgLy8gdGhlIGRhdGEgYXJyYXksIGJ1dCBmb3IgZGF0YSBzb3VyY2VzIGFzIGFuIGFycmF5LCB0aGV5IG5lZWQgdG8NCiAgICAgICAgICAgIC8vIGJlIGZsaXBwZWQNCiAgICAgICAgICAgIGlmICggZGF0YS5zcmMgIT09ICdkb20nICYmICQuaXNBcnJheSggZGF0YS5fYURhdGEgKSApIHsNCiAgICAgICAgICAgICAgICBmbkFycmF5U3dpdGNoKCBkYXRhLl9hRGF0YSwgaUZyb20sIGlUbyApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLyogUmVwb3NpdGlvbiB0aGUgaGVhZGVyIGVsZW1lbnRzIGluIHRoZSBoZWFkZXIgbGF5b3V0IGFycmF5ICovDQogICAgICAgIGZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9IZWFkZXIubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgZm5BcnJheVN3aXRjaCggb1NldHRpbmdzLmFvSGVhZGVyW2ldLCBpRnJvbSwgaVRvICk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIG9TZXR0aW5ncy5hb0Zvb3RlciAhPT0gbnVsbCApDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9Gb290ZXIubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBmbkFycmF5U3dpdGNoKCBvU2V0dGluZ3MuYW9Gb290ZXJbaV0sIGlGcm9tLCBpVG8gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICggaW52YWxpZGF0ZVJvd3MgfHwgaW52YWxpZGF0ZVJvd3MgPT09IHVuZGVmaW5lZCApDQogICAgICAgIHsNCiAgICAgICAgICAgICQuZm4uZGF0YVRhYmxlLkFwaSggb1NldHRpbmdzICkucm93cygpLmludmFsaWRhdGUoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qDQogICAgICAgICAqIFVwZGF0ZSBEYXRhVGFibGVzJyBldmVudCBoYW5kbGVycw0KICAgICAgICAgKi8NCg0KICAgICAgICAvKiBTb3J0IGxpc3RlbmVyICovDQogICAgICAgIGZvciAoIGk9MCwgaUxlbj1pQ29scyA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgIHsNCiAgICAgICAgICAgICQob1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGgpLm9mZignY2xpY2suRFQnKTsNCiAgICAgICAgICAgIHRoaXMub0FwaS5fZm5Tb3J0QXR0YWNoTGlzdGVuZXIoIG9TZXR0aW5ncywgb1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGgsIGkgKTsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgLyogRmlyZSBhbiBldmVudCBzbyBvdGhlciBwbHVnLWlucyBjYW4gdXBkYXRlICovDQogICAgICAgICQob1NldHRpbmdzLm9JbnN0YW5jZSkudHJpZ2dlciggJ2NvbHVtbi1yZW9yZGVyLmR0JywgWyBvU2V0dGluZ3MsIHsNCiAgICAgICAgICAgIGZyb206IGlGcm9tLA0KICAgICAgICAgICAgdG86IGlUbywNCiAgICAgICAgICAgIG1hcHBpbmc6IGFpSW52ZXJ0TWFwcGluZywNCiAgICAgICAgICAgIGRyb3A6IGRyb3AsDQoNCiAgICAgICAgICAgIC8vIE9sZCBzdHlsZSBwYXJhbWV0ZXJzIGZvciBjb21wYXRpYmlsaXR5DQogICAgICAgICAgICBpRnJvbTogaUZyb20sDQogICAgICAgICAgICBpVG86IGlUbywNCiAgICAgICAgICAgIGFpSW52ZXJ0TWFwcGluZzogYWlJbnZlcnRNYXBwaW5nDQogICAgICAgIH0gXSApOw0KICAgIH07DQoNCiAgICAvKioNCiAgICAgKiBDb2xSZW9yZGVyIHByb3ZpZGVzIGNvbHVtbiB2aXNpYmlsaXR5IGNvbnRyb2wgZm9yIERhdGFUYWJsZXMNCiAgICAgKiBAY2xhc3MgQ29sUmVvcmRlcg0KICAgICAqIEBjb25zdHJ1Y3Rvcg0KICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkdCBEYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdA0KICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIENvbFJlb3JkZXIgb3B0aW9ucw0KICAgICAqLw0KICAgIHZhciBDb2xSZW9yZGVyID0gZnVuY3Rpb24oIGR0LCBvcHRzICkNCiAgICB7DQogICAgICAgIHZhciBzZXR0aW5ncyA9IG5ldyAkLmZuLmRhdGFUYWJsZS5BcGkoIGR0ICkuc2V0dGluZ3MoKVswXTsNCg0KICAgICAgICAvLyBFbnN1cmUgdGhhdCB3ZSBjYW4ndCBpbml0aWFsaXNlIG9uIHRoZSBzYW1lIHRhYmxlIHR3aWNlDQogICAgICAgIGlmICggc2V0dGluZ3MuX2NvbFJlb3JkZXIgKSB7DQogICAgICAgICAgICByZXR1cm4gc2V0dGluZ3MuX2NvbFJlb3JkZXI7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBBbGxvdyB0aGUgb3B0aW9ucyB0byBiZSBhIGJvb2xlYW4gZm9yIGRlZmF1bHRzDQogICAgICAgIGlmICggb3B0cyA9PT0gdHJ1ZSApIHsNCiAgICAgICAgICAgIG9wdHMgPSB7fTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIENvbnZlcnQgZnJvbSBjYW1lbENhc2UgdG8gSHVuZ2FyaWFuLCBqdXN0IGFzIERhdGFUYWJsZXMgZG9lcw0KICAgICAgICB2YXIgY2FtZWxUb0h1bmdhcmlhbiA9ICQuZm4uZGF0YVRhYmxlLmNhbWVsVG9IdW5nYXJpYW47DQogICAgICAgIGlmICggY2FtZWxUb0h1bmdhcmlhbiApIHsNCiAgICAgICAgICAgIGNhbWVsVG9IdW5nYXJpYW4oIENvbFJlb3JkZXIuZGVmYXVsdHMsIENvbFJlb3JkZXIuZGVmYXVsdHMsIHRydWUgKTsNCiAgICAgICAgICAgIGNhbWVsVG9IdW5nYXJpYW4oIENvbFJlb3JkZXIuZGVmYXVsdHMsIG9wdHMgfHwge30gKTsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KICAgICAgICAgKiBQdWJsaWMgY2xhc3MgdmFyaWFibGVzDQogICAgICAgICAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEBuYW1lc3BhY2UgU2V0dGluZ3Mgb2JqZWN0IHdoaWNoIGNvbnRhaW5zIGN1c3RvbWlzYWJsZSBpbmZvcm1hdGlvbiBmb3IgQ29sUmVvcmRlciBpbnN0YW5jZQ0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5zID0gew0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBEYXRhVGFibGVzIHNldHRpbmdzIG9iamVjdA0KICAgICAgICAgICAgICogIEBwcm9wZXJ0eSBkdA0KICAgICAgICAgICAgICogIEB0eXBlICAgICBPYmplY3QNCiAgICAgICAgICAgICAqICBAZGVmYXVsdCAgbnVsbA0KICAgICAgICAgICAgICovDQogICAgICAgICAgICAiZHQiOiBudWxsLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIEluaXRpYWxpc2F0aW9uIG9iamVjdCB1c2VkIGZvciB0aGlzIGluc3RhbmNlDQogICAgICAgICAgICAgKiAgQHByb3BlcnR5IGluaXQNCiAgICAgICAgICAgICAqICBAdHlwZSAgICAgb2JqZWN0DQogICAgICAgICAgICAgKiAgQGRlZmF1bHQgIHt9DQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJpbml0IjogJC5leHRlbmQoIHRydWUsIHt9LCBDb2xSZW9yZGVyLmRlZmF1bHRzLCBvcHRzICksDQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogTnVtYmVyIG9mIGNvbHVtbnMgdG8gZml4IChub3QgYWxsb3cgdG8gYmUgcmVvcmRlcmVkKQ0KICAgICAgICAgICAgICogIEBwcm9wZXJ0eSBmaXhlZA0KICAgICAgICAgICAgICogIEB0eXBlICAgICBpbnQNCiAgICAgICAgICAgICAqICBAZGVmYXVsdCAgMA0KICAgICAgICAgICAgICovDQogICAgICAgICAgICAiZml4ZWQiOiAwLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIE51bWJlciBvZiBjb2x1bW5zIHRvIGZpeCBjb3VudGluZyBmcm9tIHJpZ2h0IChub3QgYWxsb3cgdG8gYmUgcmVvcmRlcmVkKQ0KICAgICAgICAgICAgICogIEBwcm9wZXJ0eSBmaXhlZFJpZ2h0DQogICAgICAgICAgICAgKiAgQHR5cGUgICAgIGludA0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICAwDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJmaXhlZFJpZ2h0IjogMCwNCg0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBDYWxsYmFjayBmdW5jdGlvbiBmb3Igb25jZSB0aGUgcmVvcmRlciBoYXMgYmVlbiBkb25lDQogICAgICAgICAgICAgKiAgQHByb3BlcnR5IHJlb3JkZXJDYWxsYmFjaw0KICAgICAgICAgICAgICogIEB0eXBlICAgICBmdW5jdGlvbg0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJyZW9yZGVyQ2FsbGJhY2siOiBudWxsLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIEBuYW1lc3BhY2UgSW5mb3JtYXRpb24gdXNlZCBmb3IgdGhlIG1vdXNlIGRyYWcNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgIm1vdXNlIjogew0KICAgICAgICAgICAgICAgICJzdGFydFgiOiAtMSwNCiAgICAgICAgICAgICAgICAic3RhcnRZIjogLTEsDQogICAgICAgICAgICAgICAgIm9mZnNldFgiOiAtMSwNCiAgICAgICAgICAgICAgICAib2Zmc2V0WSI6IC0xLA0KICAgICAgICAgICAgICAgICJ0YXJnZXQiOiAtMSwNCiAgICAgICAgICAgICAgICAidGFyZ2V0SW5kZXgiOiAtMSwNCiAgICAgICAgICAgICAgICAiZnJvbUluZGV4IjogLTENCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogSW5mb3JtYXRpb24gd2hpY2ggaXMgdXNlZCBmb3IgcG9zaXRpb25pbmcgdGhlIGluc2VydCBjdXNvciBhbmQga25vd2luZyB3aGVyZSB0byBkbyB0aGUNCiAgICAgICAgICAgICAqIGluc2VydC4gQXJyYXkgb2Ygb2JqZWN0cyB3aXRoIHRoZSBwcm9wZXJ0aWVzOg0KICAgICAgICAgICAgICogICB4OiB4LWF4aXMgcG9zaXRpb24NCiAgICAgICAgICAgICAqICAgdG86IGluc2VydCBwb2ludA0KICAgICAgICAgICAgICogIEBwcm9wZXJ0eSBhb1RhcmdldHMNCiAgICAgICAgICAgICAqICBAdHlwZSAgICAgYXJyYXkNCiAgICAgICAgICAgICAqICBAZGVmYXVsdCAgW10NCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgImFvVGFyZ2V0cyI6IFtdDQogICAgICAgIH07DQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogQG5hbWVzcGFjZSBDb21tb24gYW5kIHVzZWZ1bCBET00gZWxlbWVudHMgZm9yIHRoZSBjbGFzcyBpbnN0YW5jZQ0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5kb20gPSB7DQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIERyYWdnaW5nIGVsZW1lbnQgKHRoZSBvbmUgdGhlIG1vdXNlIGlzIG1vdmluZykNCiAgICAgICAgICAgICAqICBAcHJvcGVydHkgZHJhZw0KICAgICAgICAgICAgICogIEB0eXBlICAgICBlbGVtZW50DQogICAgICAgICAgICAgKiAgQGRlZmF1bHQgIG51bGwNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgImRyYWciOiBudWxsLA0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIFRoZSBpbnNlcnQgY3Vyc29yDQogICAgICAgICAgICAgKiAgQHByb3BlcnR5IHBvaW50ZXINCiAgICAgICAgICAgICAqICBAdHlwZSAgICAgZWxlbWVudA0KICAgICAgICAgICAgICogIEBkZWZhdWx0ICBudWxsDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICJwb2ludGVyIjogbnVsbA0KICAgICAgICB9Ow0KDQoNCiAgICAgICAgLyogQ29uc3RydWN0b3IgbG9naWMgKi8NCiAgICAgICAgdGhpcy5zLmR0ID0gc2V0dGluZ3M7DQogICAgICAgIHRoaXMucy5kdC5fY29sUmVvcmRlciA9IHRoaXM7DQogICAgICAgIHRoaXMuX2ZuQ29uc3RydWN0KCk7DQoNCiAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgfTsNCg0KDQoNCiAgICAkLmV4dGVuZCggQ29sUmVvcmRlci5wcm90b3R5cGUsIHsNCiAgICAgICAgLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KICAgICAgICAgKiBQdWJsaWMgbWV0aG9kcw0KICAgICAgICAgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLw0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBSZXNldCB0aGUgY29sdW1uIG9yZGVyaW5nIHRvIHRoZSBvcmlnaW5hbCBvcmRlcmluZyB0aGF0IHdhcyBkZXRlY3RlZCBvbg0KICAgICAgICAgKiBzdGFydCB1cC4NCiAgICAgICAgICogIEByZXR1cm4ge3RoaXN9IFJldHVybnMgYHRoaXNgIGZvciBjaGFpbmluZy4NCiAgICAgICAgICoNCiAgICAgICAgICogIEBleGFtcGxlDQogICAgICAgICAqICAgIC8vIERhdGFUYWJsZXMgaW5pdGlhbGlzYXRpb24gd2l0aCBDb2xSZW9yZGVyDQogICAgICAgICAqICAgIHZhciB0YWJsZSA9ICQoJyNleGFtcGxlJykuZGF0YVRhYmxlKCB7DQoJICogICAgICAgICJzRG9tIjogJ1JsZnJ0aXAnDQoJICogICAgfSApOw0KICAgICAgICAgKg0KICAgICAgICAgKiAgICAvLyBBZGQgY2xpY2sgZXZlbnQgdG8gYSBidXR0b24gdG8gcmVzZXQgdGhlIG9yZGVyaW5nDQogICAgICAgICAqICAgICQoJyNyZXNldE9yZGVyaW5nJykuY2xpY2soIGZ1bmN0aW9uIChlKSB7DQoJICogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCgkgKiAgICAgICAgJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciggdGFibGUgKS5mblJlc2V0KCk7DQoJICogICAgfSApOw0KICAgICAgICAgKi8NCiAgICAgICAgImZuUmVzZXQiOiBmdW5jdGlvbiAoKQ0KICAgICAgICB7DQogICAgICAgICAgICB0aGlzLl9mbk9yZGVyQ29sdW1ucyggdGhpcy5mbk9yZGVyKCkgKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHRoaXM7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIGBEZXByZWNhdGVkYCAtIEdldCB0aGUgY3VycmVudCBvcmRlciBvZiB0aGUgY29sdW1ucywgYXMgYW4gYXJyYXkuDQogICAgICAgICAqICBAcmV0dXJuIHthcnJheX0gQXJyYXkgb2YgY29sdW1uIGlkZW50aWZpZXJzDQogICAgICAgICAqICBAZGVwcmVjYXRlZCBgZm5PcmRlcmAgc2hvdWxkIGJlIHVzZWQgaW4gcHJlZmVyZW5jZSB0byB0aGlzIG1ldGhvZC4NCiAgICAgICAgICogICAgICBgZm5PcmRlcmAgYWN0cyBhcyBhIGdldHRlci9zZXR0ZXIuDQogICAgICAgICAqLw0KICAgICAgICAiZm5HZXRDdXJyZW50T3JkZXIiOiBmdW5jdGlvbiAoKQ0KICAgICAgICB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5mbk9yZGVyKCk7DQogICAgICAgIH0sDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEdldCB0aGUgY3VycmVudCBvcmRlciBvZiB0aGUgY29sdW1ucywgYXMgYW4gYXJyYXkuIE5vdGUgdGhhdCB0aGUgdmFsdWVzDQogICAgICAgICAqIGdpdmVuIGluIHRoZSBhcnJheSBhcmUgdW5pcXVlIGlkZW50aWZpZXJzIGZvciBlYWNoIGNvbHVtbi4gQ3VycmVudGx5DQogICAgICAgICAqIHRoZXNlIGFyZSB0aGUgb3JpZ2luYWwgb3JkZXJpbmcgb2YgdGhlIGNvbHVtbnMgdGhhdCB3YXMgZGV0ZWN0ZWQgb24NCiAgICAgICAgICogc3RhcnQgdXAsIGJ1dCB0aGlzIGNvdWxkIHBvdGVudGlhbGx5IGNoYW5nZSBpbiBmdXR1cmUuDQogICAgICAgICAqICBAcmV0dXJuIHthcnJheX0gQXJyYXkgb2YgY29sdW1uIGlkZW50aWZpZXJzDQogICAgICAgICAqDQogICAgICAgICAqICBAZXhhbXBsZQ0KICAgICAgICAgKiAgICAvLyBHZXQgY29sdW1uIG9yZGVyaW5nIGZvciB0aGUgdGFibGUNCiAgICAgICAgICogICAgdmFyIG9yZGVyID0gJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciggZGF0YVRhYmxlICkuZm5PcmRlcigpOw0KICAgICAgICAgKi8vKioNCiAgICAgICAgICogU2V0IHRoZSBvcmRlciBvZiB0aGUgY29sdW1ucywgZnJvbSB0aGUgcG9zaXRpb25zIGlkZW50aWZpZWQgaW4gdGhlDQogICAgICAgICAqIG9yZGVyaW5nIGFycmF5IGdpdmVuLiBOb3RlIHRoYXQgQ29sUmVvcmRlciB0YWtlcyBhIGJydXRlIGZvcmNlIGFwcHJvYWNoDQogICAgICAgICAqIHRvIHJlb3JkZXJpbmcsIHNvIGl0IGlzIHBvc3NpYmxlIG11bHRpcGxlIHJlb3JkZXJpbmcgZXZlbnRzIHdpbGwgb2NjdXINCiAgICAgICAgICogYmVmb3JlIHRoZSBmaW5hbCBvcmRlciBpcyBzZXR0bGVkIHVwb24uDQogICAgICAgICAqICBAcGFyYW0ge2FycmF5fSBbc2V0XSBBcnJheSBvZiBjb2x1bW4gaWRlbnRpZmllcnMgaW4gdGhlIG5ldyBvcmRlci4gTm90ZQ0KICAgICAgICAgKiAgICB0aGF0IGV2ZXJ5IGNvbHVtbiBtdXN0IGJlIGluY2x1ZGVkLCB1bmlxdWVseSwgaW4gdGhpcyBhcnJheS4NCiAgICAgICAgICogIEByZXR1cm4ge3RoaXN9IFJldHVybnMgYHRoaXNgIGZvciBjaGFpbmluZy4NCiAgICAgICAgICoNCiAgICAgICAgICogIEBleGFtcGxlDQogICAgICAgICAqICAgIC8vIFN3YXAgdGhlIGZpcnN0IGFuZCBzZWNvbmQgY29sdW1ucw0KICAgICAgICAgKiAgICAkLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyKCBkYXRhVGFibGUgKS5mbk9yZGVyKCBbMSwgMCwgMiwgMywgNF0gKTsNCiAgICAgICAgICoNCiAgICAgICAgICogIEBleGFtcGxlDQogICAgICAgICAqICAgIC8vIE1vdmUgdGhlIGZpcnN0IGNvbHVtbiB0byB0aGUgZW5kIGZvciB0aGUgdGFibGUgYCNleGFtcGxlYA0KICAgICAgICAgKiAgICB2YXIgY3VyciA9ICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoICcjZXhhbXBsZScgKS5mbk9yZGVyKCk7DQogICAgICAgICAqICAgIHZhciBmaXJzdCA9IGN1cnIuc2hpZnQoKTsNCiAgICAgICAgICogICAgY3Vyci5wdXNoKCBmaXJzdCApOw0KICAgICAgICAgKiAgICAkLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyKCAnI2V4YW1wbGUnICkuZm5PcmRlciggY3VyciApOw0KICAgICAgICAgKg0KICAgICAgICAgKiAgQGV4YW1wbGUNCiAgICAgICAgICogICAgLy8gUmV2ZXJzZSB0aGUgdGFibGUncyBvcmRlcg0KICAgICAgICAgKiAgICAkLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyKCAnI2V4YW1wbGUnICkuZm5PcmRlcigNCiAgICAgICAgICogICAgICAkLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyKCAnI2V4YW1wbGUnICkuZm5PcmRlcigpLnJldmVyc2UoKQ0KICAgICAgICAgKiAgICApOw0KICAgICAgICAgKi8NCiAgICAgICAgImZuT3JkZXIiOiBmdW5jdGlvbiAoIHNldCwgb3JpZ2luYWwgKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgYSA9IFtdLCBpLCBpZW4sIGosIGplbjsNCiAgICAgICAgICAgIHZhciBjb2x1bW5zID0gdGhpcy5zLmR0LmFvQ29sdW1uczsNCg0KICAgICAgICAgICAgaWYgKCBzZXQgPT09IHVuZGVmaW5lZCApew0KICAgICAgICAgICAgICAgIGZvciAoIGk9MCwgaWVuPWNvbHVtbnMubGVuZ3RoIDsgaTxpZW4gOyBpKysgKSB7DQogICAgICAgICAgICAgICAgICAgIGEucHVzaCggY29sdW1uc1tpXS5fQ29sUmVvcmRlcl9pT3JpZ0NvbCApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiBhOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBUaGUgb3JkZXIgZ2l2ZW4gaXMgYmFzZWQgb24gdGhlIG9yaWdpbmFsIGluZGV4ZXMsIHJhdGhlciB0aGFuIHRoZQ0KICAgICAgICAgICAgLy8gZXhpc3Rpbmcgb25lcywgc28gd2UgbmVlZCB0byB0cmFuc2xhdGUgZnJvbSB0aGUgb3JpZ2luYWwgdG8gY3VycmVudA0KICAgICAgICAgICAgLy8gYmVmb3JlIHRoZW4gZG9pbmcgdGhlIG9yZGVyDQogICAgICAgICAgICBpZiAoIG9yaWdpbmFsICkgew0KICAgICAgICAgICAgICAgIHZhciBvcmRlciA9IHRoaXMuZm5PcmRlcigpOw0KDQogICAgICAgICAgICAgICAgZm9yICggaT0wLCBpZW49c2V0Lmxlbmd0aCA7IGk8aWVuIDsgaSsrICkgew0KICAgICAgICAgICAgICAgICAgICBhLnB1c2goICQuaW5BcnJheSggc2V0W2ldLCBvcmRlciApICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgc2V0ID0gYTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5fZm5PcmRlckNvbHVtbnMoIGZuSW52ZXJ0S2V5VmFsdWVzKCBzZXQgKSApOw0KDQogICAgICAgICAgICByZXR1cm4gdGhpczsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDb252ZXJ0IGZyb20gdGhlIG9yaWdpbmFsIGNvbHVtbiBpbmRleCwgdG8gdGhlIG9yaWdpbmFsDQogICAgICAgICAqDQogICAgICAgICAqIEBwYXJhbSAge2ludHxhcnJheX0gaWR4IEluZGV4KGVzKSB0byBjb252ZXJ0DQogICAgICAgICAqIEBwYXJhbSAge3N0cmluZ30gZGlyIFRyYW5zcG9zZSBkaXJlY3Rpb24gLSBgZnJvbU9yaWdpbmFsYCAvIGB0b0N1cnJlbnRgDQogICAgICAgICAqICAgb3IgYCd0b09yaWdpbmFsYCAvIGBmcm9tQ3VycmVudGANCiAgICAgICAgICogQHJldHVybiB7aW50fGFycmF5fSAgICAgQ29udmVydGVkIHZhbHVlcw0KICAgICAgICAgKi8NCiAgICAgICAgZm5UcmFuc3Bvc2U6IGZ1bmN0aW9uICggaWR4LCBkaXIgKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoICEgZGlyICkgew0KICAgICAgICAgICAgICAgIGRpciA9ICd0b0N1cnJlbnQnOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgb3JkZXIgPSB0aGlzLmZuT3JkZXIoKTsNCiAgICAgICAgICAgIHZhciBjb2x1bW5zID0gdGhpcy5zLmR0LmFvQ29sdW1uczsNCg0KICAgICAgICAgICAgaWYgKCBkaXIgPT09ICd0b0N1cnJlbnQnICkgew0KICAgICAgICAgICAgICAgIC8vIEdpdmVuIGFuIG9yaWdpbmFsIGluZGV4LCB3YW50IHRoZSBjdXJyZW50DQogICAgICAgICAgICAgICAgcmV0dXJuICEgJC5pc0FycmF5KCBpZHggKSA/DQogICAgICAgICAgICAgICAgICAgICQuaW5BcnJheSggaWR4LCBvcmRlciApIDoNCiAgICAgICAgICAgICAgICAgICAgJC5tYXAoIGlkeCwgZnVuY3Rpb24gKCBpbmRleCApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkLmluQXJyYXkoIGluZGV4LCBvcmRlciApOw0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBHaXZlbiBhIGN1cnJlbnQgaW5kZXgsIHdhbnQgdGhlIG9yaWdpbmFsDQogICAgICAgICAgICAgICAgcmV0dXJuICEgJC5pc0FycmF5KCBpZHggKSA/DQogICAgICAgICAgICAgICAgICAgIGNvbHVtbnNbaWR4XS5fQ29sUmVvcmRlcl9pT3JpZ0NvbCA6DQogICAgICAgICAgICAgICAgICAgICQubWFwKCBpZHgsIGZ1bmN0aW9uICggaW5kZXggKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sdW1uc1tpbmRleF0uX0NvbFJlb3JkZXJfaU9yaWdDb2w7DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCiAgICAgICAgICogUHJpdmF0ZSBtZXRob2RzICh0aGV5IGFyZSBvZiBjb3Vyc2UgcHVibGljIGluIEpTLCBidXQgcmVjb21tZW5kZWQgYXMgcHJpdmF0ZSkNCiAgICAgICAgICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8NCg0KICAgICAgICAvKioNCiAgICAgICAgICogQ29uc3RydWN0b3IgbG9naWMNCiAgICAgICAgICogIEBtZXRob2QgIF9mbkNvbnN0cnVjdA0KICAgICAgICAgKiAgQHJldHVybnMgdm9pZA0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5Db25zdHJ1Y3QiOiBmdW5jdGlvbiAoKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQogICAgICAgICAgICB2YXIgaUxlbiA9IHRoaXMucy5kdC5hb0NvbHVtbnMubGVuZ3RoOw0KICAgICAgICAgICAgdmFyIHRhYmxlID0gdGhpcy5zLmR0Lm5UYWJsZTsNCiAgICAgICAgICAgIHZhciBpOw0KDQogICAgICAgICAgICAvKiBDb2x1bW5zIGRpc2NvdW50ZWQgZnJvbSByZW9yZGVyaW5nIC0gY291bnRpbmcgbGVmdCB0byByaWdodCAqLw0KICAgICAgICAgICAgaWYgKCB0aGlzLnMuaW5pdC5pRml4ZWRDb2x1bW5zICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aGlzLnMuZml4ZWQgPSB0aGlzLnMuaW5pdC5pRml4ZWRDb2x1bW5zOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIHRoaXMucy5pbml0LmlGaXhlZENvbHVtbnNMZWZ0ICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aGlzLnMuZml4ZWQgPSB0aGlzLnMuaW5pdC5pRml4ZWRDb2x1bW5zTGVmdDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogQ29sdW1ucyBkaXNjb3VudGVkIGZyb20gcmVvcmRlcmluZyAtIGNvdW50aW5nIHJpZ2h0IHRvIGxlZnQgKi8NCiAgICAgICAgICAgIHRoaXMucy5maXhlZFJpZ2h0ID0gdGhpcy5zLmluaXQuaUZpeGVkQ29sdW1uc1JpZ2h0ID8NCiAgICAgICAgICAgICAgICB0aGlzLnMuaW5pdC5pRml4ZWRDb2x1bW5zUmlnaHQgOg0KICAgICAgICAgICAgICAgIDA7DQoNCiAgICAgICAgICAgIC8qIERyb3AgY2FsbGJhY2sgaW5pdGlhbGlzYXRpb24gb3B0aW9uICovDQogICAgICAgICAgICBpZiAoIHRoaXMucy5pbml0LmZuUmVvcmRlckNhbGxiYWNrICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aGlzLnMucmVvcmRlckNhbGxiYWNrID0gdGhpcy5zLmluaXQuZm5SZW9yZGVyQ2FsbGJhY2s7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIEFkZCBldmVudCBoYW5kbGVycyBmb3IgdGhlIGRyYWcgYW5kIGRyb3AsIGFuZCBhbHNvIG1hcmsgdGhlIG9yaWdpbmFsIGNvbHVtbiBvcmRlciAqLw0KICAgICAgICAgICAgZm9yICggaSA9IDA7IGkgPCBpTGVuOyBpKysgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmICggaSA+IHRoaXMucy5maXhlZC0xICYmIGkgPCBpTGVuIC0gdGhpcy5zLmZpeGVkUmlnaHQgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZm5Nb3VzZUxpc3RlbmVyKCBpLCB0aGlzLnMuZHQuYW9Db2x1bW5zW2ldLm5UaCApOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8qIE1hcmsgdGhlIG9yaWdpbmFsIGNvbHVtbiBvcmRlciBmb3IgbGF0ZXIgcmVmZXJlbmNlICovDQogICAgICAgICAgICAgICAgdGhpcy5zLmR0LmFvQ29sdW1uc1tpXS5fQ29sUmVvcmRlcl9pT3JpZ0NvbCA9IGk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIFN0YXRlIHNhdmluZyAqLw0KICAgICAgICAgICAgdGhpcy5zLmR0Lm9BcGkuX2ZuQ2FsbGJhY2tSZWcoIHRoaXMucy5kdCwgJ2FvU3RhdGVTYXZlUGFyYW1zJywgZnVuY3Rpb24gKG9TLCBvRGF0YSkgew0KICAgICAgICAgICAgICAgIHRoYXQuX2ZuU3RhdGVTYXZlLmNhbGwoIHRoYXQsIG9EYXRhICk7DQogICAgICAgICAgICB9LCAiQ29sUmVvcmRlcl9TdGF0ZSIgKTsNCg0KICAgICAgICAgICAgLyogQW4gaW5pdGlhbCBjb2x1bW4gb3JkZXIgaGFzIGJlZW4gc3BlY2lmaWVkICovDQogICAgICAgICAgICB2YXIgYWlPcmRlciA9IG51bGw7DQogICAgICAgICAgICBpZiAoIHRoaXMucy5pbml0LmFpT3JkZXIgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGFpT3JkZXIgPSB0aGlzLnMuaW5pdC5haU9yZGVyLnNsaWNlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIFN0YXRlIGxvYWRpbmcsIG92ZXJyaWRlcyB0aGUgY29sdW1uIG9yZGVyIGdpdmVuICovDQogICAgICAgICAgICBpZiAoIHRoaXMucy5kdC5vTG9hZGVkU3RhdGUgJiYgdHlwZW9mIHRoaXMucy5kdC5vTG9hZGVkU3RhdGUuQ29sUmVvcmRlciAhPSAndW5kZWZpbmVkJyAmJg0KICAgICAgICAgICAgICAgIHRoaXMucy5kdC5vTG9hZGVkU3RhdGUuQ29sUmVvcmRlci5sZW5ndGggPT0gdGhpcy5zLmR0LmFvQ29sdW1ucy5sZW5ndGggKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGFpT3JkZXIgPSB0aGlzLnMuZHQub0xvYWRlZFN0YXRlLkNvbFJlb3JkZXI7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIElmIHdlIGhhdmUgYW4gb3JkZXIgdG8gYXBwbHkgLSBkbyBzbyAqLw0KICAgICAgICAgICAgaWYgKCBhaU9yZGVyICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvKiBXZSBtaWdodCBiZSBjYWxsZWQgZHVyaW5nIG9yIGFmdGVyIHRoZSBEYXRhVGFibGVzIGluaXRpYWxpc2F0aW9uLiBJZiBiZWZvcmUsIHRoZW4gd2UgbmVlZA0KICAgICAgICAgICAgICAgICAqIHRvIHdhaXQgdW50aWwgdGhlIGRyYXcgaXMgZG9uZSwgaWYgYWZ0ZXIsIHRoZW4gZG8gd2hhdCB3ZSBuZWVkIHRvIGRvIHJpZ2h0IGF3YXkNCiAgICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICBpZiAoICF0aGF0LnMuZHQuX2JJbml0Q29tcGxldGUgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGJEb25lID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICQodGFibGUpLm9uKCAnZHJhdy5kdC5jb2xSZW9yZGVyJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhdGhhdC5zLmR0Ll9iSW5pdENvbXBsZXRlICYmICFiRG9uZSApDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYkRvbmUgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNvcnQgPSBmbkludmVydEtleVZhbHVlcyggYWlPcmRlciApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZuT3JkZXJDb2x1bW5zLmNhbGwoIHRoYXQsIHJlc29ydCApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHZhciByZXNvcnQgPSBmbkludmVydEtleVZhbHVlcyggYWlPcmRlciApOw0KICAgICAgICAgICAgICAgICAgICB0aGF0Ll9mbk9yZGVyQ29sdW1ucy5jYWxsKCB0aGF0LCByZXNvcnQgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLl9mblNldENvbHVtbkluZGV4ZXMoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gRGVzdHJveSBjbGVhbiB1cA0KICAgICAgICAgICAgJCh0YWJsZSkub24oICdkZXN0cm95LmR0LmNvbFJlb3JkZXInLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgJCh0YWJsZSkub2ZmKCAnZGVzdHJveS5kdC5jb2xSZW9yZGVyIGRyYXcuZHQuY29sUmVvcmRlcicgKTsNCiAgICAgICAgICAgICAgICAkKHRoYXQucy5kdC5uVEhlYWQpLmZpbmQoICcqJyApLm9mZiggJy5Db2xSZW9yZGVyJyApOw0KDQogICAgICAgICAgICAgICAgJC5lYWNoKCB0aGF0LnMuZHQuYW9Db2x1bW5zLCBmdW5jdGlvbiAoaSwgY29sdW1uKSB7DQogICAgICAgICAgICAgICAgICAgICQoY29sdW1uLm5UaCkucmVtb3ZlQXR0cignZGF0YS1jb2x1bW4taW5kZXgnKTsNCiAgICAgICAgICAgICAgICB9ICk7DQoNCiAgICAgICAgICAgICAgICB0aGF0LnMuZHQuX2NvbFJlb3JkZXIgPSBudWxsOw0KICAgICAgICAgICAgICAgIHRoYXQucyA9IG51bGw7DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogU2V0IHRoZSBjb2x1bW4gb3JkZXIgZnJvbSBhbiBhcnJheQ0KICAgICAgICAgKiAgQG1ldGhvZCAgX2ZuT3JkZXJDb2x1bW5zDQogICAgICAgICAqICBAcGFyYW0gICBhcnJheSBhIEFuIGFycmF5IG9mIGludGVnZXJzIHdoaWNoIGRpY3RhdGUgdGhlIGNvbHVtbiBvcmRlciB0aGF0IHNob3VsZCBiZSBhcHBsaWVkDQogICAgICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbk9yZGVyQ29sdW1ucyI6IGZ1bmN0aW9uICggYSApDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gZmFsc2U7DQoNCiAgICAgICAgICAgIGlmICggYS5sZW5ndGggIT0gdGhpcy5zLmR0LmFvQ29sdW1ucy5sZW5ndGggKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMucy5kdC5vSW5zdGFuY2Uub0FwaS5fZm5Mb2coIHRoaXMucy5kdCwgMSwgIkNvbFJlb3JkZXIgLSBhcnJheSByZW9yZGVyIGRvZXMgbm90ICIrDQogICAgICAgICAgICAgICAgICAgICJtYXRjaCBrbm93biBudW1iZXIgb2YgY29sdW1ucy4gU2tpcHBpbmcuIiApOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZm9yICggdmFyIGk9MCwgaUxlbj1hLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdmFyIGN1cnJJbmRleCA9ICQuaW5BcnJheSggaSwgYSApOw0KICAgICAgICAgICAgICAgIGlmICggaSAhPSBjdXJySW5kZXggKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLyogUmVvcmRlciBvdXIgc3dpdGNoaW5nIGFycmF5ICovDQogICAgICAgICAgICAgICAgICAgIGZuQXJyYXlTd2l0Y2goIGEsIGN1cnJJbmRleCwgaSApOw0KDQogICAgICAgICAgICAgICAgICAgIC8qIERvIHRoZSBjb2x1bW4gcmVvcmRlciBpbiB0aGUgdGFibGUgKi8NCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zLmR0Lm9JbnN0YW5jZS5mbkNvbFJlb3JkZXIoIGN1cnJJbmRleCwgaSwgdHJ1ZSwgZmFsc2UgKTsNCg0KICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICQuZm4uZGF0YVRhYmxlLkFwaSggdGhpcy5zLmR0ICkucm93cygpLmludmFsaWRhdGUoKTsNCg0KICAgICAgICAgICAgdGhpcy5fZm5TZXRDb2x1bW5JbmRleGVzKCk7DQoNCiAgICAgICAgICAgIC8vIEhhcyBhbnl0aGluZyBhY3R1YWxseSBjaGFuZ2VkPyBJZiBub3QsIHRoZW4gbm90aGluZyBlbHNlIHRvIGRvDQogICAgICAgICAgICBpZiAoICEgY2hhbmdlZCApIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIFdoZW4gc2Nyb2xsaW5nIHdlIG5lZWQgdG8gcmVjYWxjdWxhdGUgdGhlIGNvbHVtbiBzaXplcyB0byBhbGxvdyBmb3IgdGhlIHNoaWZ0ICovDQogICAgICAgICAgICBpZiAoIHRoaXMucy5kdC5vU2Nyb2xsLnNYICE9PSAiIiB8fCB0aGlzLnMuZHQub1Njcm9sbC5zWSAhPT0gIiIgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMucy5kdC5vSW5zdGFuY2UuZm5BZGp1c3RDb2x1bW5TaXppbmcoIGZhbHNlICk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIFNhdmUgdGhlIHN0YXRlICovDQogICAgICAgICAgICB0aGlzLnMuZHQub0luc3RhbmNlLm9BcGkuX2ZuU2F2ZVN0YXRlKCB0aGlzLnMuZHQgKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLnMucmVvcmRlckNhbGxiYWNrICE9PSBudWxsICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aGlzLnMucmVvcmRlckNhbGxiYWNrLmNhbGwoIHRoaXMgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBCZWNhdXNlIHdlIGNoYW5nZSB0aGUgaW5kZXhlcyBvZiBjb2x1bW5zIGluIHRoZSB0YWJsZSwgcmVsYXRpdmUgdG8gdGhlaXIgc3RhcnRpbmcgcG9pbnQNCiAgICAgICAgICogd2UgbmVlZCB0byByZW9yZGVyIHRoZSBzdGF0ZSBjb2x1bW5zIHRvIHdoYXQgdGhleSBhcmUgYXQgdGhlIHN0YXJ0aW5nIHBvaW50IHNvIHdlIGNhbg0KICAgICAgICAgKiB0aGVuIHJlYXJyYW5nZSB0aGVtIGFnYWluIG9uIHN0YXRlIGxvYWQhDQogICAgICAgICAqICBAbWV0aG9kICBfZm5TdGF0ZVNhdmUNCiAgICAgICAgICogIEBwYXJhbSAgIG9iamVjdCBvU3RhdGUgRGF0YVRhYmxlcyBzdGF0ZQ0KICAgICAgICAgKiAgQHJldHVybnMgc3RyaW5nIEpTT04gZW5jb2RlZCBjb29raWUgc3RyaW5nIGZvciBEYXRhVGFibGVzDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mblN0YXRlU2F2ZSI6IGZ1bmN0aW9uICggb1N0YXRlICkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIGksIGlMZW4sIGFDb3B5LCBpT3JpZ0NvbHVtbjsNCiAgICAgICAgICAgIHZhciBvU2V0dGluZ3MgPSB0aGlzLnMuZHQ7DQogICAgICAgICAgICB2YXIgY29sdW1ucyA9IG9TZXR0aW5ncy5hb0NvbHVtbnM7DQoNCiAgICAgICAgICAgIG9TdGF0ZS5Db2xSZW9yZGVyID0gW107DQoNCiAgICAgICAgICAgIC8qIFNvcnRpbmcgKi8NCiAgICAgICAgICAgIGlmICggb1N0YXRlLmFhU29ydGluZyApIHsNCiAgICAgICAgICAgICAgICAvLyAxLjEwLjAtDQogICAgICAgICAgICAgICAgZm9yICggaT0wIDsgaTxvU3RhdGUuYWFTb3J0aW5nLmxlbmd0aCA7IGkrKyApIHsNCiAgICAgICAgICAgICAgICAgICAgb1N0YXRlLmFhU29ydGluZ1tpXVswXSA9IGNvbHVtbnNbIG9TdGF0ZS5hYVNvcnRpbmdbaV1bMF0gXS5fQ29sUmVvcmRlcl9pT3JpZ0NvbDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB2YXIgYVNlYXJjaENvcHkgPSAkLmV4dGVuZCggdHJ1ZSwgW10sIG9TdGF0ZS5hb1NlYXJjaENvbHMgKTsNCg0KICAgICAgICAgICAgICAgIGZvciAoIGk9MCwgaUxlbj1jb2x1bW5zLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpT3JpZ0NvbHVtbiA9IGNvbHVtbnNbaV0uX0NvbFJlb3JkZXJfaU9yaWdDb2w7DQoNCiAgICAgICAgICAgICAgICAgICAgLyogQ29sdW1uIGZpbHRlciAqLw0KICAgICAgICAgICAgICAgICAgICBvU3RhdGUuYW9TZWFyY2hDb2xzWyBpT3JpZ0NvbHVtbiBdID0gYVNlYXJjaENvcHlbaV07DQoNCiAgICAgICAgICAgICAgICAgICAgLyogVmlzaWJpbGl0eSAqLw0KICAgICAgICAgICAgICAgICAgICBvU3RhdGUuYWJWaXNDb2xzWyBpT3JpZ0NvbHVtbiBdID0gY29sdW1uc1tpXS5iVmlzaWJsZTsNCg0KICAgICAgICAgICAgICAgICAgICAvKiBDb2x1bW4gcmVvcmRlcmluZyAqLw0KICAgICAgICAgICAgICAgICAgICBvU3RhdGUuQ29sUmVvcmRlci5wdXNoKCBpT3JpZ0NvbHVtbiApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYgKCBvU3RhdGUub3JkZXIgKSB7DQogICAgICAgICAgICAgICAgLy8gMS4xMC4xKw0KICAgICAgICAgICAgICAgIGZvciAoIGk9MCA7IGk8b1N0YXRlLm9yZGVyLmxlbmd0aCA7IGkrKyApIHsNCiAgICAgICAgICAgICAgICAgICAgb1N0YXRlLm9yZGVyW2ldWzBdID0gY29sdW1uc1sgb1N0YXRlLm9yZGVyW2ldWzBdIF0uX0NvbFJlb3JkZXJfaU9yaWdDb2w7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdmFyIHN0YXRlQ29sdW1uc0NvcHkgPSAkLmV4dGVuZCggdHJ1ZSwgW10sIG9TdGF0ZS5jb2x1bW5zICk7DQoNCiAgICAgICAgICAgICAgICBmb3IgKCBpPTAsIGlMZW49Y29sdW1ucy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaU9yaWdDb2x1bW4gPSBjb2x1bW5zW2ldLl9Db2xSZW9yZGVyX2lPcmlnQ29sOw0KDQogICAgICAgICAgICAgICAgICAgIC8qIENvbHVtbnMgKi8NCiAgICAgICAgICAgICAgICAgICAgb1N0YXRlLmNvbHVtbnNbIGlPcmlnQ29sdW1uIF0gPSBzdGF0ZUNvbHVtbnNDb3B5W2ldOw0KDQogICAgICAgICAgICAgICAgICAgIC8qIENvbHVtbiByZW9yZGVyaW5nICovDQogICAgICAgICAgICAgICAgICAgIG9TdGF0ZS5Db2xSZW9yZGVyLnB1c2goIGlPcmlnQ29sdW1uICk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KICAgICAgICAgKiBNb3VzZSBkcm9wIGFuZCBkcmFnDQogICAgICAgICAqLw0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBBZGQgYSBtb3VzZSBkb3duIGxpc3RlbmVyIHRvIGEgcGFydGljbHVhciBUSCBlbGVtZW50DQogICAgICAgICAqICBAbWV0aG9kICBfZm5Nb3VzZUxpc3RlbmVyDQogICAgICAgICAqICBAcGFyYW0gICBpbnQgaSBDb2x1bW4gaW5kZXgNCiAgICAgICAgICogIEBwYXJhbSAgIGVsZW1lbnQgblRoIFRIIGVsZW1lbnQgY2xpY2tlZCBvbg0KICAgICAgICAgKiAgQHJldHVybnMgdm9pZA0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5Nb3VzZUxpc3RlbmVyIjogZnVuY3Rpb24gKCBpLCBuVGggKQ0KICAgICAgICB7DQogICAgICAgICAgICAvKg0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KICAgICAgICAgICAgJChuVGgpDQogICAgICAgICAgICAgICAgLm9uKCAnbW91c2Vkb3duLkNvbFJlb3JkZXInLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZuTW91c2VEb3duLmNhbGwoIHRoYXQsIGUsIG5UaCApOw0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5vbiggJ3RvdWNoc3RhcnQuQ29sUmVvcmRlcicsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZuTW91c2VEb3duLmNhbGwoIHRoYXQsIGUsIG5UaCApOw0KICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICAqLw0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIE1vdXNlIGRvd24gb24gYSBUSCBlbGVtZW50IGluIHRoZSB0YWJsZSBoZWFkZXINCiAgICAgICAgICogIEBtZXRob2QgIF9mbk1vdXNlRG93bg0KICAgICAgICAgKiAgQHBhcmFtICAgZXZlbnQgZSBNb3VzZSBldmVudA0KICAgICAgICAgKiAgQHBhcmFtICAgZWxlbWVudCBuVGggVEggZWxlbWVudCB0byBiZSBkcmFnZ2VkDQogICAgICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbk1vdXNlRG93biI6IGZ1bmN0aW9uICggZSwgblRoICkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KDQogICAgICAgICAgICAvKiBTdG9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgbW91c2UgcG9zaXRpb24gKi8NCiAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCd0aCwgdGQnKTsNCiAgICAgICAgICAgIHZhciBvZmZzZXQgPSB0YXJnZXQub2Zmc2V0KCk7DQogICAgICAgICAgICB2YXIgaWR4ID0gcGFyc2VJbnQoICQoblRoKS5hdHRyKCdkYXRhLWNvbHVtbi1pbmRleCcpLCAxMCApOw0KDQogICAgICAgICAgICBpZiAoIGlkeCA9PT0gdW5kZWZpbmVkICkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdGhpcy5zLm1vdXNlLnN0YXJ0WCA9IHRoaXMuX2ZuQ3Vyc29yUG9zaXRpb24oIGUsICdwYWdlWCcgKTsNCiAgICAgICAgICAgIHRoaXMucy5tb3VzZS5zdGFydFkgPSB0aGlzLl9mbkN1cnNvclBvc2l0aW9uKCBlLCAncGFnZVknICk7DQogICAgICAgICAgICB0aGlzLnMubW91c2Uub2Zmc2V0WCA9IHRoaXMuX2ZuQ3Vyc29yUG9zaXRpb24oIGUsICdwYWdlWCcgKSAtIG9mZnNldC5sZWZ0Ow0KICAgICAgICAgICAgdGhpcy5zLm1vdXNlLm9mZnNldFkgPSB0aGlzLl9mbkN1cnNvclBvc2l0aW9uKCBlLCAncGFnZVknICkgLSBvZmZzZXQudG9wOw0KICAgICAgICAgICAgdGhpcy5zLm1vdXNlLnRhcmdldCA9IHRoaXMucy5kdC5hb0NvbHVtbnNbIGlkeCBdLm5UaDsvL3RhcmdldFswXTsNCiAgICAgICAgICAgIHRoaXMucy5tb3VzZS50YXJnZXRJbmRleCA9IGlkeDsNCiAgICAgICAgICAgIHRoaXMucy5tb3VzZS5mcm9tSW5kZXggPSBpZHg7DQoNCiAgICAgICAgICAgIHRoaXMuX2ZuUmVnaW9ucygpOw0KDQogICAgICAgICAgICAvKiBBZGQgZXZlbnQgaGFuZGxlcnMgdG8gdGhlIGRvY3VtZW50ICovDQogICAgICAgICAgICAkKGRvY3VtZW50KQ0KICAgICAgICAgICAgICAgIC5vbiggJ21vdXNlbW92ZS5Db2xSZW9yZGVyIHRvdWNobW92ZS5Db2xSZW9yZGVyJywgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fZm5Nb3VzZU1vdmUuY2FsbCggdGhhdCwgZSApOw0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5vbiggJ21vdXNldXAuQ29sUmVvcmRlciB0b3VjaGVuZC5Db2xSZW9yZGVyJywgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhhdC5fZm5Nb3VzZVVwLmNhbGwoIHRoYXQsIGUgKTsNCiAgICAgICAgICAgICAgICB9ICk7DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogRGVhbCB3aXRoIGEgbW91c2UgbW92ZSBldmVudCB3aGlsZSBkcmFnZ2luZyBhIG5vZGUNCiAgICAgICAgICogIEBtZXRob2QgIF9mbk1vdXNlTW92ZQ0KICAgICAgICAgKiAgQHBhcmFtICAgZXZlbnQgZSBNb3VzZSBldmVudA0KICAgICAgICAgKiAgQHJldHVybnMgdm9pZA0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5Nb3VzZU1vdmUiOiBmdW5jdGlvbiAoIGUgKQ0KICAgICAgICB7DQogICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgICAgICAgIGlmICggdGhpcy5kb20uZHJhZyA9PT0gbnVsbCApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLyogT25seSBjcmVhdGUgdGhlIGRyYWcgZWxlbWVudCBpZiB0aGUgbW91c2UgaGFzIG1vdmVkIGEgc3BlY2lmaWMgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQNCiAgICAgICAgICAgICAgICAgKiBwb2ludCAtIHRoaXMgYWxsb3dzIHRoZSB1c2VyIHRvIG1ha2Ugc21hbGwgbW91c2UgbW92ZW1lbnRzIHdoZW4gc29ydGluZyBhbmQgbm90IGhhdmUgYQ0KICAgICAgICAgICAgICAgICAqIHBvc3NpYmx5IGNvbmZ1c2luZyBkcmFnIGVsZW1lbnQgc2hvd2luZyB1cA0KICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgIGlmICggTWF0aC5wb3coDQogICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnBvdyh0aGlzLl9mbkN1cnNvclBvc2l0aW9uKCBlLCAncGFnZVgnKSAtIHRoaXMucy5tb3VzZS5zdGFydFgsIDIpICsNCiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucG93KHRoaXMuX2ZuQ3Vyc29yUG9zaXRpb24oIGUsICdwYWdlWScpIC0gdGhpcy5zLm1vdXNlLnN0YXJ0WSwgMiksIDAuNSApIDwgNSApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuX2ZuQ3JlYXRlRHJhZ05vZGUoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogUG9zaXRpb24gdGhlIGVsZW1lbnQgLSB3ZSByZXNwZWN0IHdoZXJlIGluIHRoZSBlbGVtZW50IHRoZSBjbGljayBvY2N1cmVkICovDQogICAgICAgICAgICB0aGlzLmRvbS5kcmFnLmNzcyggew0KICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMuX2ZuQ3Vyc29yUG9zaXRpb24oIGUsICdwYWdlWCcgKSAtIHRoaXMucy5tb3VzZS5vZmZzZXRYLA0KICAgICAgICAgICAgICAgIHRvcDogdGhpcy5fZm5DdXJzb3JQb3NpdGlvbiggZSwgJ3BhZ2VZJyApIC0gdGhpcy5zLm1vdXNlLm9mZnNldFkNCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgLyogQmFzZWQgb24gdGhlIGN1cnJlbnQgbW91c2UgcG9zaXRpb24sIGNhbGN1bGF0ZSB3aGVyZSB0aGUgaW5zZXJ0IHNob3VsZCBnbyAqLw0KICAgICAgICAgICAgdmFyIGJTZXQgPSBmYWxzZTsNCiAgICAgICAgICAgIHZhciBsYXN0VG9JbmRleCA9IHRoaXMucy5tb3VzZS50b0luZGV4Ow0KDQogICAgICAgICAgICBmb3IgKCB2YXIgaT0xLCBpTGVuPXRoaXMucy5hb1RhcmdldHMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuX2ZuQ3Vyc29yUG9zaXRpb24oZSwgJ3BhZ2VYJykgPCB0aGlzLnMuYW9UYXJnZXRzW2ktMV0ueCArICgodGhpcy5zLmFvVGFyZ2V0c1tpXS54LXRoaXMucy5hb1RhcmdldHNbaS0xXS54KS8yKSApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbS5wb2ludGVyLmNzcyggJ2xlZnQnLCB0aGlzLnMuYW9UYXJnZXRzW2ktMV0ueCApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnMubW91c2UudG9JbmRleCA9IHRoaXMucy5hb1RhcmdldHNbaS0xXS50bzsNCiAgICAgICAgICAgICAgICAgICAgYlNldCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gVGhlIGluc2VydCBlbGVtZW50IHdhc24ndCBwb3NpdGlvbmVkIGluIHRoZSBhcnJheSAobGVzcyB0aGFuDQogICAgICAgICAgICAvLyBvcGVyYXRvciksIHNvIHdlIHB1dCBpdCBhdCB0aGUgZW5kDQogICAgICAgICAgICBpZiAoICFiU2V0ICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aGlzLmRvbS5wb2ludGVyLmNzcyggJ2xlZnQnLCB0aGlzLnMuYW9UYXJnZXRzW3RoaXMucy5hb1RhcmdldHMubGVuZ3RoLTFdLnggKTsNCiAgICAgICAgICAgICAgICB0aGlzLnMubW91c2UudG9JbmRleCA9IHRoaXMucy5hb1RhcmdldHNbdGhpcy5zLmFvVGFyZ2V0cy5sZW5ndGgtMV0udG87DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFBlcmZvcm0gcmVvcmRlcmluZyBpZiByZWFsdGltZSB1cGRhdGluZyBpcyBvbiBhbmQgdGhlIGNvbHVtbiBoYXMgbW92ZWQNCiAgICAgICAgICAgIGlmICggdGhpcy5zLmluaXQuYlJlYWx0aW1lICYmIGxhc3RUb0luZGV4ICE9PSB0aGlzLnMubW91c2UudG9JbmRleCApIHsNCiAgICAgICAgICAgICAgICB0aGlzLnMuZHQub0luc3RhbmNlLmZuQ29sUmVvcmRlciggdGhpcy5zLm1vdXNlLmZyb21JbmRleCwgdGhpcy5zLm1vdXNlLnRvSW5kZXgsIGZhbHNlICk7DQogICAgICAgICAgICAgICAgdGhpcy5zLm1vdXNlLmZyb21JbmRleCA9IHRoaXMucy5tb3VzZS50b0luZGV4Ow0KICAgICAgICAgICAgICAgIHRoaXMuX2ZuUmVnaW9ucygpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEZpbmlzaCBvZmYgdGhlIG1vdXNlIGRyYWcgYW5kIGluc2VydCB0aGUgY29sdW1uIHdoZXJlIG5lZWRlZA0KICAgICAgICAgKiAgQG1ldGhvZCAgX2ZuTW91c2VVcA0KICAgICAgICAgKiAgQHBhcmFtICAgZXZlbnQgZSBNb3VzZSBldmVudA0KICAgICAgICAgKiAgQHJldHVybnMgdm9pZA0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5Nb3VzZVVwIjogZnVuY3Rpb24gKCBlICkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KDQogICAgICAgICAgICAkKGRvY3VtZW50KS5vZmYoICcuQ29sUmVvcmRlcicgKTsNCg0KICAgICAgICAgICAgaWYgKCB0aGlzLmRvbS5kcmFnICE9PSBudWxsICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvKiBSZW1vdmUgdGhlIGd1aWRlIGVsZW1lbnRzICovDQogICAgICAgICAgICAgICAgdGhpcy5kb20uZHJhZy5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICB0aGlzLmRvbS5wb2ludGVyLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLmRyYWcgPSBudWxsOw0KICAgICAgICAgICAgICAgIHRoaXMuZG9tLnBvaW50ZXIgPSBudWxsOw0KDQogICAgICAgICAgICAgICAgLyogQWN0dWFsbHkgZG8gdGhlIHJlb3JkZXIgKi8NCiAgICAgICAgICAgICAgICB0aGlzLnMuZHQub0luc3RhbmNlLmZuQ29sUmVvcmRlciggdGhpcy5zLm1vdXNlLmZyb21JbmRleCwgdGhpcy5zLm1vdXNlLnRvSW5kZXgsIHRydWUgKTsNCiAgICAgICAgICAgICAgICB0aGlzLl9mblNldENvbHVtbkluZGV4ZXMoKTsNCg0KICAgICAgICAgICAgICAgIC8qIFdoZW4gc2Nyb2xsaW5nIHdlIG5lZWQgdG8gcmVjYWxjdWxhdGUgdGhlIGNvbHVtbiBzaXplcyB0byBhbGxvdyBmb3IgdGhlIHNoaWZ0ICovDQogICAgICAgICAgICAgICAgaWYgKCB0aGlzLnMuZHQub1Njcm9sbC5zWCAhPT0gIiIgfHwgdGhpcy5zLmR0Lm9TY3JvbGwuc1kgIT09ICIiICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucy5kdC5vSW5zdGFuY2UuZm5BZGp1c3RDb2x1bW5TaXppbmcoIGZhbHNlICk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLyogU2F2ZSB0aGUgc3RhdGUgKi8NCiAgICAgICAgICAgICAgICB0aGlzLnMuZHQub0luc3RhbmNlLm9BcGkuX2ZuU2F2ZVN0YXRlKCB0aGlzLnMuZHQgKTsNCg0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5zLnJlb3JkZXJDYWxsYmFjayAhPT0gbnVsbCApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnMucmVvcmRlckNhbGxiYWNrLmNhbGwoIHRoaXMgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCg0KICAgICAgICAvKioNCiAgICAgICAgICogQ2FsY3VsYXRlIGEgY2FjaGVkIGFycmF5IHdpdGggdGhlIHBvaW50cyBvZiB0aGUgY29sdW1uIGluc2VydHMsIGFuZCB0aGUNCiAgICAgICAgICogJ3RvJyBwb2ludHMNCiAgICAgICAgICogIEBtZXRob2QgIF9mblJlZ2lvbnMNCiAgICAgICAgICogIEByZXR1cm5zIHZvaWQNCiAgICAgICAgICogIEBwcml2YXRlDQogICAgICAgICAqLw0KICAgICAgICAiX2ZuUmVnaW9ucyI6IGZ1bmN0aW9uICgpDQogICAgICAgIHsNCiAgICAgICAgICAgIHZhciBhb0NvbHVtbnMgPSB0aGlzLnMuZHQuYW9Db2x1bW5zOw0KDQogICAgICAgICAgICB0aGlzLnMuYW9UYXJnZXRzLnNwbGljZSggMCwgdGhpcy5zLmFvVGFyZ2V0cy5sZW5ndGggKTsNCg0KICAgICAgICAgICAgdGhpcy5zLmFvVGFyZ2V0cy5wdXNoKCB7DQogICAgICAgICAgICAgICAgIngiOiAgJCh0aGlzLnMuZHQublRhYmxlKS5vZmZzZXQoKS5sZWZ0LA0KICAgICAgICAgICAgICAgICJ0byI6IDANCiAgICAgICAgICAgIH0gKTsNCg0KICAgICAgICAgICAgdmFyIGlUb1BvaW50ID0gMDsNCiAgICAgICAgICAgIHZhciB0b3RhbCA9IHRoaXMucy5hb1RhcmdldHNbMF0ueDsNCg0KICAgICAgICAgICAgZm9yICggdmFyIGk9MCwgaUxlbj1hb0NvbHVtbnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAvKiBGb3IgdGhlIGNvbHVtbiAvIGhlYWRlciBpbiBxdWVzdGlvbiwgd2Ugd2FudCBpdCdzIHBvc2l0aW9uIHRvIHJlbWFpbiB0aGUgc2FtZSBpZiB0aGUNCiAgICAgICAgICAgICAgICAgKiBwb3NpdGlvbiBpcyBqdXN0IHRvIGl0J3MgaW1tZWRpYXRlIGxlZnQgb3IgcmlnaHQsIHNvIHdlIG9ubHkgaW5jcmVtZW50IHRoZSBjb3VudGVyIGZvcg0KICAgICAgICAgICAgICAgICAqIG90aGVyIGNvbHVtbnMNCiAgICAgICAgICAgICAgICAgKi8NCiAgICAgICAgICAgICAgICBpZiAoIGkgIT0gdGhpcy5zLm1vdXNlLmZyb21JbmRleCApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpVG9Qb2ludCsrOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICggYW9Db2x1bW5zW2ldLmJWaXNpYmxlICYmIGFvQ29sdW1uc1tpXS5uVGguc3R5bGUuZGlzcGxheSAhPT0nbm9uZScgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdG90YWwgKz0gJChhb0NvbHVtbnNbaV0ublRoKS5vdXRlcldpZHRoKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zLmFvVGFyZ2V0cy5wdXNoKCB7DQogICAgICAgICAgICAgICAgICAgICAgICAieCI6ICB0b3RhbCwNCiAgICAgICAgICAgICAgICAgICAgICAgICJ0byI6IGlUb1BvaW50DQogICAgICAgICAgICAgICAgICAgIH0gKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIERpc2FsbG93IGNvbHVtbnMgZm9yIGJlaW5nIHJlb3JkZXJlZCBieSBkcmFnIGFuZCBkcm9wLCBjb3VudGluZyByaWdodCB0byBsZWZ0ICovDQogICAgICAgICAgICBpZiAoIHRoaXMucy5maXhlZFJpZ2h0ICE9PSAwICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0aGlzLnMuYW9UYXJnZXRzLnNwbGljZSggdGhpcy5zLmFvVGFyZ2V0cy5sZW5ndGggLSB0aGlzLnMuZml4ZWRSaWdodCApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKiBEaXNhbGxvdyBjb2x1bW5zIGZvciBiZWluZyByZW9yZGVyZWQgYnkgZHJhZyBhbmQgZHJvcCwgY291bnRpbmcgbGVmdCB0byByaWdodCAqLw0KICAgICAgICAgICAgaWYgKCB0aGlzLnMuZml4ZWQgIT09IDAgKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHRoaXMucy5hb1RhcmdldHMuc3BsaWNlKCAwLCB0aGlzLnMuZml4ZWQgKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDb3B5IHRoZSBUSCBlbGVtZW50IHRoYXQgaXMgYmVpbmcgZHJhZ3Mgc28gdGhlIHVzZXIgaGFzIHRoZSBpZGVhIHRoYXQgdGhleSBhcmUgYWN0dWFsbHkNCiAgICAgICAgICogbW92aW5nIGl0IGFyb3VuZCB0aGUgcGFnZS4NCiAgICAgICAgICogIEBtZXRob2QgIF9mbkNyZWF0ZURyYWdOb2RlDQogICAgICAgICAqICBAcmV0dXJucyB2b2lkDQogICAgICAgICAqICBAcHJpdmF0ZQ0KICAgICAgICAgKi8NCiAgICAgICAgIl9mbkNyZWF0ZURyYWdOb2RlIjogZnVuY3Rpb24gKCkNCiAgICAgICAgew0KICAgICAgICAgICAgdmFyIHNjcm9sbGluZyA9IHRoaXMucy5kdC5vU2Nyb2xsLnNYICE9PSAiIiB8fCB0aGlzLnMuZHQub1Njcm9sbC5zWSAhPT0gIiI7DQoNCiAgICAgICAgICAgIHZhciBvcmlnQ2VsbCA9IHRoaXMucy5kdC5hb0NvbHVtbnNbIHRoaXMucy5tb3VzZS50YXJnZXRJbmRleCBdLm5UaDsNCiAgICAgICAgICAgIHZhciBvcmlnVHIgPSBvcmlnQ2VsbC5wYXJlbnROb2RlOw0KICAgICAgICAgICAgdmFyIG9yaWdUaGVhZCA9IG9yaWdUci5wYXJlbnROb2RlOw0KICAgICAgICAgICAgdmFyIG9yaWdUYWJsZSA9IG9yaWdUaGVhZC5wYXJlbnROb2RlOw0KICAgICAgICAgICAgdmFyIGNsb25lQ2VsbCA9ICQob3JpZ0NlbGwpLmNsb25lKCk7DQoNCiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBzbGlnaHRseSBvZGQgY29tYmluYXRpb24gb2YgalF1ZXJ5IGFuZCBET00sIGJ1dCBpdCBpcyB0aGUNCiAgICAgICAgICAgIC8vIGZhc3Rlc3QgYW5kIGxlYXN0IHJlc291cmNlIGludGVuc2l2ZSB3YXkgSSBjb3VsZCB0aGluayBvZiBjbG9uaW5nDQogICAgICAgICAgICAvLyB0aGUgdGFibGUgd2l0aCBqdXN0IGEgc2luZ2xlIGhlYWRlciBjZWxsIGluIGl0Lg0KICAgICAgICAgICAgdGhpcy5kb20uZHJhZyA9ICQob3JpZ1RhYmxlLmNsb25lTm9kZShmYWxzZSkpDQogICAgICAgICAgICAgICAgLmFkZENsYXNzKCAnRFRDUl9jbG9uZWRUYWJsZScgKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmQoDQogICAgICAgICAgICAgICAgICAgICQob3JpZ1RoZWFkLmNsb25lTm9kZShmYWxzZSkpLmFwcGVuZCgNCiAgICAgICAgICAgICAgICAgICAgICAgICQob3JpZ1RyLmNsb25lTm9kZShmYWxzZSkpLmFwcGVuZCgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9uZUNlbGxbMF0NCiAgICAgICAgICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICAuY3NzKCB7DQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLA0KICAgICAgICAgICAgICAgICAgICB0b3A6IDAsDQogICAgICAgICAgICAgICAgICAgIGxlZnQ6IDAsDQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAkKG9yaWdDZWxsKS5vdXRlcldpZHRoKCksDQogICAgICAgICAgICAgICAgICAgIGhlaWdodDogJChvcmlnQ2VsbCkub3V0ZXJIZWlnaHQoKQ0KICAgICAgICAgICAgICAgIH0gKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmRUbyggJ2JvZHknICk7DQoNCiAgICAgICAgICAgIHRoaXMuZG9tLnBvaW50ZXIgPSAkKCc8ZGl2PjwvZGl2PicpDQogICAgICAgICAgICAgICAgLmFkZENsYXNzKCAnRFRDUl9wb2ludGVyJyApDQogICAgICAgICAgICAgICAgLmNzcyggew0KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJywNCiAgICAgICAgICAgICAgICAgICAgdG9wOiBzY3JvbGxpbmcgPw0KICAgICAgICAgICAgICAgICAgICAgICAgJCgnZGl2LmRhdGFUYWJsZXNfc2Nyb2xsJywgdGhpcy5zLmR0Lm5UYWJsZVdyYXBwZXIpLm9mZnNldCgpLnRvcCA6DQogICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMucy5kdC5uVGFibGUpLm9mZnNldCgpLnRvcCwNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0IDogc2Nyb2xsaW5nID8NCiAgICAgICAgICAgICAgICAgICAgICAgICQoJ2Rpdi5kYXRhVGFibGVzX3Njcm9sbCcsIHRoaXMucy5kdC5uVGFibGVXcmFwcGVyKS5oZWlnaHQoKSA6DQogICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMucy5kdC5uVGFibGUpLmhlaWdodCgpDQogICAgICAgICAgICAgICAgfSApDQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKCAnYm9keScgKTsNCiAgICAgICAgfSwNCg0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBBZGQgYSBkYXRhIGF0dHJpYnV0ZSB0byB0aGUgY29sdW1uIGhlYWRlcnMsIHNvIHdlIGtub3cgdGhlIGluZGV4IG9mDQogICAgICAgICAqIHRoZSByb3cgdG8gYmUgcmVvcmRlcmVkLiBUaGlzIGFsbG93cyBmYXN0IGRldGVjdGlvbiBvZiB0aGUgaW5kZXgsIGFuZA0KICAgICAgICAgKiBmb3IgdGhpcyBwbHVnLWluIHRvIHdvcmsgd2l0aCBGaXhlZEhlYWRlciB3aGljaCBjbG9uZXMgdGhlIG5vZGVzLg0KICAgICAgICAgKiAgQHByaXZhdGUNCiAgICAgICAgICovDQogICAgICAgICJfZm5TZXRDb2x1bW5JbmRleGVzIjogZnVuY3Rpb24gKCkNCiAgICAgICAgew0KICAgICAgICAgICAgJC5lYWNoKCB0aGlzLnMuZHQuYW9Db2x1bW5zLCBmdW5jdGlvbiAoaSwgY29sdW1uKSB7DQogICAgICAgICAgICAgICAgJChjb2x1bW4ublRoKS5hdHRyKCdkYXRhLWNvbHVtbi1pbmRleCcsIGkpOw0KICAgICAgICAgICAgfSApOw0KICAgICAgICB9LA0KDQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEdldCBjdXJzb3IgcG9zaXRpb24gcmVnYXJkbGVzcyBvZiBtb3VzZSBvciB0b3VjaCBpbnB1dA0KICAgICAgICAgKiBAcGFyYW0gIHtFdmVudH0gIGUgICAgalF1ZXJ5IEV2ZW50DQogICAgICAgICAqIEBwYXJhbSAge3N0cmluZ30gcHJvcCBQcm9wZXJ0eSB0byBnZXQNCiAgICAgICAgICogQHJldHVybiB7bnVtYmVyfSAgICAgIFZhbHVlDQogICAgICAgICAqLw0KICAgICAgICBfZm5DdXJzb3JQb3NpdGlvbjogZnVuY3Rpb24gKCBlLCBwcm9wICkgew0KICAgICAgICAgICAgaWYgKCBlLnR5cGUuaW5kZXhPZigndG91Y2gnKSAhPT0gLTEgKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIGUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdWyBwcm9wIF07DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZVsgcHJvcCBdOw0KICAgICAgICB9DQogICAgfSApOw0KDQoNCg0KDQoNCiAgICAvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCiAgICAgKiBTdGF0aWMgcGFyYW1ldGVycw0KICAgICAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8NCg0KDQogICAgLyoqDQogICAgICogQ29sUmVvcmRlciBkZWZhdWx0IHNldHRpbmdzIGZvciBpbml0aWFsaXNhdGlvbg0KICAgICAqICBAbmFtZXNwYWNlDQogICAgICogIEBzdGF0aWMNCiAgICAgKi8NCiAgICBDb2xSZW9yZGVyLmRlZmF1bHRzID0gew0KICAgICAgICAvKioNCiAgICAgICAgICogUHJlZGVmaW5lZCBvcmRlcmluZyBmb3IgdGhlIGNvbHVtbnMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgYXV0b21hdGljYWxseQ0KICAgICAgICAgKiBvbiBpbml0aWFsaXNhdGlvbi4gSWYgbm90IHNwZWNpZmllZCB0aGVuIHRoZSBvcmRlciB0aGF0IHRoZSBjb2x1bW5zIGFyZQ0KICAgICAgICAgKiBmb3VuZCB0byBiZSBpbiB0aGUgSFRNTCBpcyB0aGUgb3JkZXIgdXNlZC4NCiAgICAgICAgICogIEB0eXBlIGFycmF5DQogICAgICAgICAqICBAZGVmYXVsdCBudWxsDQogICAgICAgICAqICBAc3RhdGljDQogICAgICAgICAqLw0KICAgICAgICBhaU9yZGVyOiBudWxsLA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBSZWRyYXcgdGhlIHRhYmxlJ3MgY29sdW1uIG9yZGVyaW5nIGFzIHRoZSBlbmQgdXNlciBkcmF3cyB0aGUgY29sdW1uDQogICAgICAgICAqIChgdHJ1ZWApIG9yIHdhaXQgdW50aWwgdGhlIG1vdXNlIGlzIHJlbGVhc2VkIChgZmFsc2VgIC0gZGVmYXVsdCkuIE5vdGUNCiAgICAgICAgICogdGhhdCB0aGlzIHdpbGwgcGVyZm9ybSBhIHJlZHJhdyBvbiBlYWNoIHJlb3JkZXJpbmcsIHdoaWNoIGludm9sdmVzIGFuDQogICAgICAgICAqIEFqYXggcmVxdWVzdCBlYWNoIHRpbWUgaWYgeW91IGFyZSB1c2luZyBzZXJ2ZXItc2lkZSBwcm9jZXNzaW5nIGluDQogICAgICAgICAqIERhdGFUYWJsZXMuDQogICAgICAgICAqICBAdHlwZSBib29sZWFuDQogICAgICAgICAqICBAZGVmYXVsdCBmYWxzZQ0KICAgICAgICAgKiAgQHN0YXRpYw0KICAgICAgICAgKi8NCiAgICAgICAgYlJlYWx0aW1lOiB0cnVlLA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBJbmRpY2F0ZSBob3cgbWFueSBjb2x1bW5zIHNob3VsZCBiZSBmaXhlZCBpbiBwb3NpdGlvbiAoY291bnRpbmcgZnJvbSB0aGUNCiAgICAgICAgICogbGVmdCkuIFRoaXMgd2lsbCB0eXBpY2FsbHkgYmUgMSBpZiB1c2VkLCBidXQgY2FuIGJlIGFzIGhpZ2ggYXMgeW91IGxpa2UuDQogICAgICAgICAqICBAdHlwZSBpbnQNCiAgICAgICAgICogIEBkZWZhdWx0IDANCiAgICAgICAgICogIEBzdGF0aWMNCiAgICAgICAgICovDQogICAgICAgIGlGaXhlZENvbHVtbnNMZWZ0OiAwLA0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBBcyBgaUZpeGVkQ29sdW1uc1JpZ2h0YCBidXQgY291bnRpbmcgZnJvbSB0aGUgcmlnaHQuDQogICAgICAgICAqICBAdHlwZSBpbnQNCiAgICAgICAgICogIEBkZWZhdWx0IDANCiAgICAgICAgICogIEBzdGF0aWMNCiAgICAgICAgICovDQogICAgICAgIGlGaXhlZENvbHVtbnNSaWdodDogMCwNCg0KICAgICAgICAvKioNCiAgICAgICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBpcyBmaXJlZCB3aGVuIGNvbHVtbnMgYXJlIHJlb3JkZXJlZC4gVGhlIGBjb2x1bW4tDQogICAgICAgICAqIHJlb3JkZXJgIGV2ZW50IGlzIHByZWZlcnJlZCBvdmVyIHRoaXMgY2FsbGJhY2sNCiAgICAgICAgICogIEB0eXBlIGZ1bmN0aW9uKCk6dm9pZA0KICAgICAgICAgKiAgQGRlZmF1bHQgbnVsbA0KICAgICAgICAgKiAgQHN0YXRpYw0KICAgICAgICAgKi8NCiAgICAgICAgZm5SZW9yZGVyQ2FsbGJhY2s6IG51bGwNCiAgICB9Ow0KDQoNCg0KICAgIC8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKg0KICAgICAqIENvbnN0YW50cw0KICAgICAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8NCg0KICAgIC8qKg0KICAgICAqIENvbFJlb3JkZXIgdmVyc2lvbg0KICAgICAqICBAY29uc3RhbnQgIHZlcnNpb24NCiAgICAgKiAgQHR5cGUgICAgICBTdHJpbmcNCiAgICAgKiAgQGRlZmF1bHQgICBBcyBjb2RlDQogICAgICovDQogICAgQ29sUmVvcmRlci52ZXJzaW9uID0gIjEuMy4zIjsNCg0KDQoNCiAgICAvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoNCiAgICAgKiBEYXRhVGFibGVzIGludGVyZmFjZXMNCiAgICAgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovDQoNCi8vIEV4cG9zZQ0KICAgICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIgPSBDb2xSZW9yZGVyOw0KICAgICQuZm4uRGF0YVRhYmxlLkNvbFJlb3JkZXIgPSBDb2xSZW9yZGVyOw0KDQoNCi8vIFJlZ2lzdGVyIGEgbmV3IGZlYXR1cmUgd2l0aCBEYXRhVGFibGVzDQogICAgaWYgKCB0eXBlb2YgJC5mbi5kYXRhVGFibGUgPT0gImZ1bmN0aW9uIiAmJg0KICAgICAgICB0eXBlb2YgJC5mbi5kYXRhVGFibGVFeHQuZm5WZXJzaW9uQ2hlY2sgPT0gImZ1bmN0aW9uIiAmJg0KICAgICAgICAkLmZuLmRhdGFUYWJsZUV4dC5mblZlcnNpb25DaGVjaygnMS4xMC44JykgKQ0KICAgIHsNCiAgICAgICAgJC5mbi5kYXRhVGFibGVFeHQuYW9GZWF0dXJlcy5wdXNoKCB7DQogICAgICAgICAgICAiZm5Jbml0IjogZnVuY3Rpb24oIHNldHRpbmdzICkgew0KICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IHNldHRpbmdzLm9JbnN0YW5jZTsNCg0KICAgICAgICAgICAgICAgIGlmICggISBzZXR0aW5ncy5fY29sUmVvcmRlciApIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGR0SW5pdCA9IHNldHRpbmdzLm9Jbml0Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgb3B0cyA9IGR0SW5pdC5jb2xSZW9yZGVyIHx8IGR0SW5pdC5vQ29sUmVvcmRlciB8fCB7fTsNCg0KICAgICAgICAgICAgICAgICAgICBuZXcgQ29sUmVvcmRlciggc2V0dGluZ3MsIG9wdHMgKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRhYmxlLm9BcGkuX2ZuTG9nKCBzZXR0aW5ncywgMSwgIkNvbFJlb3JkZXIgYXR0ZW1wdGVkIHRvIGluaXRpYWxpc2UgdHdpY2UuIElnbm9yaW5nIHNlY29uZCIgKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsgLyogTm8gbm9kZSBmb3IgRGF0YVRhYmxlcyB0byBpbnNlcnQgKi8NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAiY0ZlYXR1cmUiOiAiUiIsDQogICAgICAgICAgICAic0ZlYXR1cmUiOiAiQ29sUmVvcmRlciINCiAgICAgICAgfSApOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgYWxlcnQoICJXYXJuaW5nOiBDb2xSZW9yZGVyIHJlcXVpcmVzIERhdGFUYWJsZXMgMS4xMC44IG9yIGdyZWF0ZXIgLSB3d3cuZGF0YXRhYmxlcy5uZXQvZG93bmxvYWQiKTsNCiAgICB9DQoNCg0KLy8gQXR0YWNoIGEgbGlzdGVuZXIgdG8gdGhlIGRvY3VtZW50IHdoaWNoIGxpc3RlbnMgZm9yIERhdGFUYWJsZXMgaW5pdGlhbGlzYXRpb24NCi8vIGV2ZW50cyBzbyB3ZSBjYW4gYXV0b21hdGljYWxseSBpbml0aWFsaXNlDQogICAgJChkb2N1bWVudCkub24oICdwcmVJbml0LmR0LmNvbFJlb3JkZXInLCBmdW5jdGlvbiAoZSwgc2V0dGluZ3MpIHsNCiAgICAgICAgaWYgKCBlLm5hbWVzcGFjZSAhPT0gJ2R0JyApIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIHZhciBpbml0ID0gc2V0dGluZ3Mub0luaXQuY29sUmVvcmRlcjsNCiAgICAgICAgdmFyIGRlZmF1bHRzID0gRGF0YVRhYmxlLmRlZmF1bHRzLmNvbFJlb3JkZXI7DQoNCiAgICAgICAgaWYgKCBpbml0IHx8IGRlZmF1bHRzICkgew0KICAgICAgICAgICAgdmFyIG9wdHMgPSAkLmV4dGVuZCgge30sIGluaXQsIGRlZmF1bHRzICk7DQoNCiAgICAgICAgICAgIGlmICggaW5pdCAhPT0gZmFsc2UgKSB7DQogICAgICAgICAgICAgICAgbmV3IENvbFJlb3JkZXIoIHNldHRpbmdzLCBvcHRzICApOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSApOw0KDQoNCi8vIEFQSSBhdWdtZW50YXRpb24NCiAgICAkLmZuLmRhdGFUYWJsZS5BcGkucmVnaXN0ZXIoICdjb2xSZW9yZGVyLnJlc2V0KCknLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIHJldHVybiB0aGlzLml0ZXJhdG9yKCAndGFibGUnLCBmdW5jdGlvbiAoIGN0eCApIHsNCiAgICAgICAgICAgIGN0eC5fY29sUmVvcmRlci5mblJlc2V0KCk7DQogICAgICAgIH0gKTsNCiAgICB9ICk7DQoNCiAgICAkLmZuLmRhdGFUYWJsZS5BcGkucmVnaXN0ZXIoICdjb2xSZW9yZGVyLm9yZGVyKCknLCBmdW5jdGlvbiAoIHNldCwgb3JpZ2luYWwgKSB7DQogICAgICAgIGlmICggc2V0ICkgew0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXRlcmF0b3IoICd0YWJsZScsIGZ1bmN0aW9uICggY3R4ICkgew0KICAgICAgICAgICAgICAgIGN0eC5fY29sUmVvcmRlci5mbk9yZGVyKCBzZXQsIG9yaWdpbmFsICk7DQogICAgICAgICAgICB9ICk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0Lmxlbmd0aCA/DQogICAgICAgICAgICB0aGlzLmNvbnRleHRbMF0uX2NvbFJlb3JkZXIuZm5PcmRlcigpIDoNCiAgICAgICAgICAgIG51bGw7DQogICAgfSApOw0KDQogICAgJC5mbi5kYXRhVGFibGUuQXBpLnJlZ2lzdGVyKCAnY29sUmVvcmRlci50cmFuc3Bvc2UoKScsIGZ1bmN0aW9uICggaWR4LCBkaXIgKSB7DQogICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQubGVuZ3RoICYmIHRoaXMuY29udGV4dFswXS5fY29sUmVvcmRlciA/DQogICAgICAgICAgICB0aGlzLmNvbnRleHRbMF0uX2NvbFJlb3JkZXIuZm5UcmFuc3Bvc2UoIGlkeCwgZGlyICkgOg0KICAgICAgICAgICAgaWR4Ow0KICAgIH0gKTsNCg0KDQogICAgcmV0dXJuIENvbFJlb3JkZXI7DQp9KSk7Cg==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="89390281" offset="0" length="4096" />
        <PacketInfo time="89390281" offset="4096" length="7123" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>